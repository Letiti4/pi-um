(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150,9089],{93452:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/album/[album]",function(){return i(4392)}])},79089:function(e,t,i){"use strict";i.r(t);var s=i(85893),o=i(5152),a=i.n(o),n=i(61197),r=i(67294),l=i(30128),d=i(55166);let c=a()(()=>Promise.all([i.e(1664),i.e(9494),i.e(3126),i.e(9039),i.e(9584),i.e(4380)]).then(i.bind(i,84118)),{loadableGenerated:{webpack:()=>[84118]},ssr:!1,loading:()=>(0,s.jsx)(n.Z,{})});t.default=function(e){let t=(0,l.aF)(),[i,o]=(0,r.useState)();return((0,r.useEffect)(()=>{let i=[];i.push((0,d.h)(t,e.album)),i.push(t.FetchJSON("".concat("https://myalbum.com/api/v2","/access/album-").concat(e.album,"/accessData"))[0]),Promise.all(i).then(t=>{let[i,s]=t;o({key:e.album,title:s.data.subject.title,me:{role:s.data.me.role,hasBookmarked:i.user.following},access:s.data,settings:{...i.settings},canContribute:!i.user.isAlbumOwner&&i.settings.albumContributionsEnabled})})},[]),i)?(0,s.jsx)(c,{...e,album:i}):(0,s.jsx)(n.Z,{})}},96916:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var s=i(85893),o=i(36465),a=i.n(o),n=i(67294),r=i(68949),l=i(71217),d=i(45522),c=i(55637),h=i(67814),u=i(77185),m=i(47311);let p=new String(".chat-button.jsx-1568263d1dc55a7b{z-index:16000000;-webkit-box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07);-moz-box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07);box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07);display:none;-webkit-border-radius:35px;-moz-border-radius:35px;border-radius:35px;height:35px;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-left:15px;padding-right:15px;color:white;cursor:pointer;background-color:rgba(var(--accentColorDark),1);-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end}.chat-button.fixed.jsx-1568263d1dc55a7b{position:fixed;bottom:15px;right:15px}.chat-button.visible.jsx-1568263d1dc55a7b{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex}.chat-button.jsx-1568263d1dc55a7b svg{margin-right:5px}.chat-button.jsx-1568263d1dc55a7b:active{background-color:rgba(var(--accentColor),1)}");p.__hash="1568263d1dc55a7b";var b=i(11163),x=i(30128),g=function(e){let{chat:t}=(0,d.q)(),i=(0,x.aF)(),o=(0,b.useRouter)(),g=(0,c.Z)(),[f,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t.enable(!0),t.setUser(i);let e=(0,r.reaction)(()=>i.isLoggedIn,()=>{t.setUser(i)});return()=>{e()}},[]),(0,n.useEffect)(()=>{w(g.width>=700),t.resetLoadPromise()},[g.width]),(0,n.useEffect)(()=>{t.updatePath()},[o.asPath]);let y=(0,n.useCallback)(()=>{t.showWindow()},[t]);return(0,s.jsx)(l.Qj,{children:()=>{let i=["chat-button"];return f&&(t.showButton||t.isChatting&&!t.isOpen)&&i.push("visible"),void 0!==e.className&&i.push(e.className),(0,s.jsxs)("div",{onClick:y,className:"jsx-".concat(p.__hash)+" "+(i.join(" ")||""),children:[(0,s.jsx)(h.G,{icon:m.Of}),u.default.translate("chat.button-text",{count:t.unreadMessageCount}),(0,s.jsx)(a(),{id:p.__hash,children:p})]})}})}},89227:function(e,t,i){"use strict";var s=i(85893),o=i(71619),a=i(67294),n=i(77185);t.Z=function(e){let t=(0,a.useCallback)(()=>{location.href="".concat("https://myalbum.com","/premium?redirect=1&ref=download-popup")},[]);return(0,s.jsx)(o.Z,{title:n.default.translate("upsell.download.title"),text:n.default.translate("upsell.download.text"),confirmLabel:n.default.translate("base.upgrade"),onConfirm:t,onCancel:e.onClose})}},77917:function(e,t,i){"use strict";var s=i(85893),o=i(36465),a=i.n(o),n=i(67294),r=i(29323),l=i(77185);class d extends n.Component{render(){let e=[];for(let t in this.props.fields){let i=this.props.fields[t],o=this.props.data[t];if(void 0!==o){void 0!==i.values&&i.values[o]&&(o=l.default.translate(i.values[o])),Array.isArray(o)&&(o=o.join(", "));let a=null;if(void 0===i.fullwidth&&(a=(0,s.jsx)("div",{className:"sidebar-row-label",children:l.default.translate(i.label)})),void 0!==i.suffix&&!("string"==typeof i.suffix||i.suffix instanceof String)){let e="";void 0!==i.suffix.prefix&&(e+=i.suffix.prefix),e+=this.props.data[i.suffix.field],i.suffix=e}i.prefix&&l.default.translationExists(i.prefix)&&(i.prefix=l.default.translate(i.prefix)),i.suffix&&l.default.translationExists(i.suffix)&&(i.suffix=l.default.translate(i.suffix)),e.push((0,s.jsxs)("div",{className:"sidebar-row",children:[a,(0,s.jsxs)("div",{className:"sidebar-row-value",children:[i.prefix,o,i.suffix]})]},"row-"+t))}}return 0===e.length?null:(0,s.jsxs)("div",{className:"jsx-30013e9c116044f0 sidebar-group",children:[(0,s.jsx)("div",{className:"jsx-30013e9c116044f0 sidebar-group-title",children:l.default.translate(this.props.title)}),e,(0,s.jsx)(a(),{id:"30013e9c116044f0",children:'.sidebar-group.jsx-30013e9c116044f0{margin-top:30px}.sidebar-group.jsx-30013e9c116044f0 .sidebar-group-title.jsx-30013e9c116044f0{margin:0px;margin-bottom:10px;font-family:"Source Sans Pro",sans-serif;font-weight:normal;font-size:14px}.sidebar-row{font-family:"Roboto Slab",serif;font-size:11px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;line-height:135%}.sidebar-row+.sidebar-row{margin-top:5px}.sidebar-row-label{width:100px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;margin-right:15px;opacity:.6}.sidebar-row-value{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;word-break:break-word}'})]})}}t.Z=(0,r.observer)(d)},23302:function(e,t,i){"use strict";i.d(t,{Z:function(){return x}});var s=i(85893),o=i(36465),a=i.n(o),n=i(67294),r=i(72517),l=i(63717),d=i(41022),c=i(67814),h=i(71217);function u(e){let[t,i]=(0,n.useState)(!1),o=(0,n.createRef)(),a=()=>{try{o.current.select(),o.current.setSelectionRange(0,e.text.length),document.execCommand("copy"),r()}catch(t){navigator.clipboard.writeText(e.text).then(()=>r()).catch(()=>{})}},r=()=>{e.onCopied&&e.onCopied(),i(!0)};return(0,n.useEffect)(()=>{if(t){let e=setTimeout(()=>{i(!1)},2e3);return()=>{clearTimeout(e)}}},[t]),(0,s.jsx)(h.Qj,{children:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{"data-tip":e.tooltip,"data-tip-delay":0,"data-tip-align":"bottom",style:e.style,onClick:()=>a(),children:(0,s.jsx)(c.G,{fixedWidth:!0,icon:t?l.LE:d.Yj})}),(0,s.jsx)("input",{ref:o,type:"hidden",value:e.text})]})})}u.defaultProps={tooltip:void 0};let m=new String(".copy-input.jsx-9e1d41add4480e12{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;height:40px;color:rgba(var(--textColor),.7);background:rgba(var(--accentColorLightest),1);border:1px solid rgba(var(--accentColorLight),1);-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;white-space:nowrap;font-size:13px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.copy-input-text.jsx-9e1d41add4480e12{padding:0 15px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.copy-input-fixed-font.jsx-9e1d41add4480e12{font-family:Courier}.copy-input.jsx-9e1d41add4480e12 button{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;width:30px;height:100%;color:rgba(var(--textColor),.7);font-size:15px;background-color:transparent;border:0;border-left:1px solid rgba(var(--accentColorLight),1);outline:none;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;cursor:pointer}");function p(e){let{text:t,fixedFont:i,style:o,textStyle:l,buttonStyle:d,buttonTooltip:c,onCopy:h}=e,p=(0,n.useRef)(),b=["copy-input-text"];return i&&b.push("copy-input-fixed-font"),(0,n.useEffect)(()=>{if(p.current){let e=p.current,t=()=>{(0,r.eO)(e)};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}},[p]),(0,s.jsxs)("div",{style:o,className:"jsx-".concat(m.__hash)+" copy-input",children:[(0,s.jsx)("div",{ref:p,style:l,"allow-context-menu":"true",className:"jsx-".concat(m.__hash)+" "+(b.join(" ")||""),children:t}),(0,s.jsx)(u,{text:t,style:d,tooltip:c,onCopied:h}),(0,s.jsx)(a(),{id:m.__hash,children:m})]})}m.__hash="9e1d41add4480e12";let b=new String(".share-row.jsx-e7fa96335ced6caa{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.share-row.jsx-e7fa96335ced6caa+.share-row.jsx-e7fa96335ced6caa{margin-top:10px}.share-row-prefix.jsx-e7fa96335ced6caa{width:50px}");function x(e){let{urls:t,onCopy:i}=e,[o,a,n]=t,r=n||a||o||void 0,l=o||a||n||void 0;return(0,s.jsxs)(s.Fragment,{children:[o&&(0,s.jsx)(g,{prefix:"L",text:o,onCopy:i}),a&&(0,s.jsx)(g,{prefix:"M",text:a,onCopy:i}),n&&(0,s.jsx)(g,{prefix:"S",text:n,onCopy:i}),r&&(0,s.jsx)(g,{prefix:"[bb]",text:"[img]".concat(r,"[/img]"),onCopy:i}),l&&(0,s.jsx)(g,{prefix:"html",text:'<img src="'.concat(l,'" />'),onCopy:i})]})}function g(e){let{prefix:t,text:i,onCopy:o}=e;return(0,s.jsxs)("div",{className:"jsx-".concat(b.__hash)+" share-row",children:[(0,s.jsx)("span",{className:"jsx-".concat(b.__hash)+" share-row-prefix",children:t}),(0,s.jsx)(p,{text:i,onCopy:o,style:{width:"100%",maxWidth:"calc(100% - 50px)",marginRight:0,height:35},textStyle:{width:"100%"}}),(0,s.jsx)(a(),{id:b.__hash,children:b})]})}b.__hash="e7fa96335ced6caa",x.defaultProps={onCopy:()=>{}}},14024:function(e,t,i){"use strict";var s=i(85893),o=i(5152),a=i.n(o),n=i(61197);let r=a()(()=>i.e(7458).then(i.bind(i,97458)),{loadableGenerated:{webpack:()=>[97458]},ssr:!1,loading:()=>(0,s.jsx)(n.Z,{})});t.Z=r},95228:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var s=i(85893),o=i(36465),a=i.n(o),n=i(67294),r=i(67814),l=i(54470),d=i(51719),c=i(53986),h=i(76795),u=i(7531),m=i(63717),p=i(76986),b=i(45956);let x=new String('.social-share.jsx-585bb729594308a2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;border:0;background:none;color:#fff;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:12px;cursor:pointer;margin-bottom:26px;min-width:35px;min-height:35px;max-width:55px;max-height:55px;-webkit-border-radius:55px;-moz-border-radius:55px;border-radius:55px}@media(max-width:380px){.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2{margin-right:10px}}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2:after{position:absolute;bottom:-18px;display:block;color:rgba(var(--textColor),1);content:attr(data-label);font-size:11px;text-align:center}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2:last-child{margin-right:0}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.facebook.jsx-585bb729594308a2{background-color:#3b5998;cursor:wait}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.facebook.loaded.jsx-585bb729594308a2{cursor:pointer}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.twitter.jsx-585bb729594308a2{background-color:#5ea9dd}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.whatsapp.jsx-585bb729594308a2{background-color:#25d366}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.pinterest.jsx-585bb729594308a2{background-color:#ca2026}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.link.jsx-585bb729594308a2{background-color:rgba(var(--accentColorDark),1)}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.embed.jsx-585bb729594308a2{border:1px solid rgba(var(--buttonBorder),1);color:rgba(var(--buttonColor),.8)}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.mail.jsx-585bb729594308a2{background-color:rgba(27,141,244);color:white}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.more.jsx-585bb729594308a2{min-width:25px;min-height:25px;max-width:40px;max-height:40px;border:1px solid rgba(var(--buttonBorder),1);color:rgba(var(--buttonColor),.8)}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2 svg{min-width:18px;min-height:18px;max-width:25px;max-height:25px;height:-webkit-calc(8vw - 30px);height:-moz-calc(8vw - 30px);height:calc(8vw - 30px);width:-webkit-calc(8vw - 30px);width:-moz-calc(8vw - 30px);width:calc(8vw - 30px)}.social-share.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2:after{font-family:"Source Sans Pro",sans-serif;color:rgba(var(--accentColorDark),11);font-size:12px;content:attr(title)}.dark-mode.jsx-585bb729594308a2 .row.jsx-585bb729594308a2 .button.jsx-585bb729594308a2:after{color:rgba(255,255,255,.6)}');x.__hash="585bb729594308a2";var g=i(77185),f=i(24372);function w(e){let{size:t,embedCode:i}=e,[o,w]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[k,j]=(0,n.useState)(!1);(0,b.Z)(()=>(window.FB.init({appId:"729711370416789",autoLogAppEvents:!1,xfbml:!1,version:"v9.0"}),j(!0),()=>{j(!1)}),{url:"https://connect.facebook.com/en_US/sdk.js",options:{referrerPolicy:"no-referrer"}});let z=(0,n.useCallback)(()=>{navigator.clipboard.writeText(e.url).then(()=>w(!0)).catch(()=>{})},[e.url]);return(0,n.useEffect)(()=>{if(o){let e=setTimeout(()=>{w(!1)},2e3);return()=>{clearTimeout(e)}}},[o]),(0,n.useEffect)(()=>{if(y){let e=setTimeout(()=>{v(!1)},2e3);return()=>{clearTimeout(e)}}},[y]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"jsx-".concat(x.__hash)+" social-share"+(e.darkMode?" dark-mode":""),children:(0,s.jsx)("div",{className:"jsx-".concat(x.__hash)+" row",children:e.options.map(a=>{switch(a){case"whatsapp":return(0,s.jsx)("button",{title:"WhatsApp",style:{width:t,height:t},onClick:()=>{let t=window.open("https://api.whatsapp.com/send?text=".concat(encodeURIComponent(e.url)));t.focus()},className:"jsx-".concat(x.__hash)+" button whatsapp",children:(0,s.jsx)(r.G,{icon:c.VH})},"whatsapp");case"copy":return(0,s.jsx)("button",{title:g.default.translate("base.link"),style:{width:t,height:t},onClick:z,className:"jsx-".concat(x.__hash)+" button link",children:(0,s.jsx)(r.G,{icon:o?m.LE:u.nN})},"copy");case"facebook":return(0,s.jsx)("button",{title:"Facebook",style:{width:t,height:t},onClick:()=>{window.FB.ui({method:"share",href:e.url,display:"popup"})},className:"jsx-".concat(x.__hash)+" "+(["button","facebook",k?"loaded":void 0].filter(e=>e).join(" ")||""),children:(0,s.jsx)(r.G,{icon:l.AY})},"facebook");case"twitter":return(0,s.jsx)("button",{title:"Twitter",style:{width:t,height:t},onClick:()=>{let t="http://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e.url),"&via=joinmyalbum"),i=window.open(t,"twitter","location=no,menubar=no,status=no,titlebar=no,toolbar=no,width=600,height=300");i.focus()},className:"jsx-".concat(x.__hash)+" button twitter",children:(0,s.jsx)(r.G,{icon:d.md})},"twitter");case"mail":return(0,s.jsx)("a",{title:g.default.translate("base.mail"),style:{width:t,height:t},href:"mailto:?body=".concat(encodeURIComponent(e.url)),target:"_blank",rel:"noreferrer",className:"jsx-".concat(x.__hash)+" button mail",children:(0,s.jsx)(r.G,{icon:f.FU})},"mail");case"embed":if(i)return(0,s.jsx)("button",{title:"Embed",style:{width:t,height:t},onClick:()=>{navigator.clipboard.writeText(i).then(()=>v(!0)).catch(()=>{})},className:"jsx-".concat(x.__hash)+" button embed",children:(0,s.jsx)(r.G,{icon:y?m.LE:p.dT})},"embed");break;case"more":if(window.navigator&&window.navigator.share&&window.navigator.canShare)return(0,s.jsx)("button",{style:{width:"calc(".concat(isNaN(t)?t:"".concat(t,"px")," - 10px)"),height:"calc(".concat(isNaN(t)?t:"".concat(t,"px")," - 10px)")},onClick:()=>window.navigator.share({url:e.url}).catch(()=>{}),className:"jsx-".concat(x.__hash)+" button more",children:(0,s.jsx)(r.G,{icon:h.cN})},"more")}})})}),(0,s.jsx)(a(),{id:x.__hash,children:x})]})}w.defaultProps={options:["copy","mail","whatsapp","facebook","twitter","embed","more"],size:"11vw",darkMode:!1}},16855:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});var s=i(85893),o=i(36465),a=i.n(o),n=i(67814),r=i(55426);let l=new String('.ui-checkbox.jsx-e0fd28934d6f34f9{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;cursor:pointer}.ui-checkbox.jsx-e0fd28934d6f34f9 .ui-checkbox-button.jsx-e0fd28934d6f34f9{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;width:16px;height:16px;border:1px solid rgba(var(--inputBorder),1);background:rgba(var(--backgroundColor),1);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.ui-checkbox.jsx-e0fd28934d6f34f9 .ui-checkbox-button.jsx-e0fd28934d6f34f9 svg{position:absolute;top:2px;left:2px;width:12px;height:12px}.ui-checkbox.jsx-e0fd28934d6f34f9 .ui-checkbox-button.jsx-e0fd28934d6f34f9:after{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;content:"";width:6px;height:6px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;background-color:transparent}.ui-checkbox.selected.jsx-e0fd28934d6f34f9 .ui-checkbox-button.jsx-e0fd28934d6f34f9{border-color:rgba(var(--accentColor),1);background-color:rgba(var(--accentColor),1)}.ui-checkbox.selected.jsx-e0fd28934d6f34f9 .ui-checkbox-button.jsx-e0fd28934d6f34f9 .checkmark.jsx-e0fd28934d6f34f9{color:rgba(var(--textColor),1)}.ui-checkbox.jsx-e0fd28934d6f34f9 .ui-checkbox-content.jsx-e0fd28934d6f34f9{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin-left:10px}');l.__hash="e0fd28934d6f34f9";var d=i(52081),c=i(91173);function h(e){let t=()=>{e.onChange&&e.onChange.call(null,!e.selected)},i=e.selected?"#".concat(c.Z.rgbToHex(d.Z.theme.buttonActiveColor)):"transparent";return(0,s.jsxs)("div",{onClick:()=>t(),style:e.style,className:"jsx-".concat(l.__hash)+" "+"ui-checkbox".concat(e.selected?" selected":""),children:[(0,s.jsx)("div",{style:e.buttonStyle,className:"jsx-".concat(l.__hash)+" ui-checkbox-button",children:(0,s.jsx)(n.G,{width:1,color:i,icon:r.LE})}),(0,s.jsx)("div",{style:e.contentStyle,className:"jsx-".concat(l.__hash)+" ui-checkbox-content",children:e.children}),(0,s.jsx)(a(),{id:l.__hash,children:l})]})}h.defaultProps={selected:!1}},84528:function(e,t,i){"use strict";i.d(t,{v:function(){return r}});var s=i(85893),o=i(67294),a=i(21042),n=i(41333);let r=["image/bmp","image/jpg","image/jpeg","image/png","video/*"],l=(0,o.forwardRef)((e,t)=>{let{children:i,className:r,enabled:l,style:d,...c}=e,h=(0,o.useRef)(null),u=(0,o.useRef)(null);return((0,o.useImperativeHandle)(t,()=>({click:()=>{h.current.click()}})),(0,o.useEffect)(()=>()=>{u.current&&u.current()}),c.accept.toLowerCase().includes("image/*"))?(console.error("image/* is not allowed, use a whitelist"),(0,s.jsx)("div",{style:{backgroundColor:"red",color:"white",fontWeight:"bold",padding:20,paddingTop:10,paddingBottom:10,marginTop:10},children:"image/* is not allowed, use a whitelist!"})):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.Z,{style:d,className:r+(!1===l?" disabled":""),enabled:l,onClick:()=>{u.current=(0,a.lX)(e=>c.onSelect(e),c)},children:i})})});l.displayName="FileSelectButton",l.defaultProps={enabled:!0,multiple:!1,accept:r.join(",")},t.Z=l},71619:function(e,t,i){"use strict";var s=i(85893),o=i(41333),a=i(67294),n=i(77185),r=i(23927);function l(e){let t=e.confirmLabel?e.confirmLabel:n.default.translate("base.ok"),i=e.cancelLabel?e.cancelLabel:n.default.translate("base.cancel");return(0,a.useEffect)(()=>{function t(t){13===t.keyCode&&e.onConfirm()}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e.onConfirm]),(0,s.jsx)(r.Z,{onClose:e.onCancel,className:"small",style:{maxWidth:550},children:(0,s.jsxs)("div",{className:"content",children:[(0,s.jsx)("h1",{children:e.title}),(0,s.jsx)("h3",{children:e.text}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,s.jsx)(o.Z,{className:"accent large",onClick:e.onConfirm,children:t}),(0,s.jsx)(o.Z,{className:"large",onClick:e.onCancel,children:i})]})]})})}l.defaultProps={onCancel:()=>{},onConfirm:()=>{},confirmLabel:void 0,cancelLabel:void 0,title:"Title",text:"Text"},t.Z=l},84966:function(e,t,i){"use strict";i.d(t,{Z:function(){return m}});var s=i(14924),o=i(85893),a=i(36465),n=i.n(a),r=i(67294),l=i(29323),d=i(61946),c=i(52081);let h=new String(".toggle-button.jsx-9da746811b087e7c{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;height:29px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.toggle-button.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c{height:29px;width:54px;-webkit-border-radius:29px;-moz-border-radius:29px;border-radius:29px;overflow:hidden;border:1px solid transparent;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer;position:relative;z-index:11;-webkit-transition:background-color.2s ease-out,border-color.2s ease-out;-moz-transition:background-color.2s ease-out,border-color.2s ease-out;-o-transition:background-color.2s ease-out,border-color.2s ease-out;transition:background-color.2s ease-out,border-color.2s ease-out}.toggle-button.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .circle.jsx-9da746811b087e7c{width:21px;height:21px;-webkit-border-radius:21px;-moz-border-radius:21px;border-radius:21px;border:1px solid transparent;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;top:3px;left:3px;z-index:10;-webkit-transform:translatex(2px);-moz-transform:translatex(2px);-ms-transform:translatex(2px);-o-transform:translatex(2px);transform:translatex(2px);-webkit-transition:-webkit-transform.2s ease-out;-moz-transition:-moz-transform.2s ease-out;-o-transition:-o-transform.2s ease-out;transition:-webkit-transform.2s ease-out;transition:-moz-transform.2s ease-out;transition:-o-transform.2s ease-out;transition:transform.2s ease-out}.toggle-button.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .lines.jsx-9da746811b087e7c{position:absolute;top:-6px;left:0px;right:0px;bottom:-6px;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;z-index:9;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;-webkit-animation:moveLines.6s linear infinite;-moz-animation:moveLines.6s linear infinite;-o-animation:moveLines.6s linear infinite;animation:moveLines.6s linear infinite}.toggle-button.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .lines.jsx-9da746811b087e7c .line.jsx-9da746811b087e7c{width:1px;height:100%;border-right:6px solid rgba(var(--toggleLine),.3);-webkit-transform:rotate(25deg);-moz-transform:rotate(25deg);-ms-transform:rotate(25deg);-o-transform:rotate(25deg);transform:rotate(25deg);-webkit-transform-origin:top left;-moz-transform-origin:top left;-ms-transform-origin:top left;-o-transform-origin:top left;transform-origin:top left}.toggle-button.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .lines.jsx-9da746811b087e7c .line.jsx-9da746811b087e7c+.line.jsx-9da746811b087e7c{margin-left:6px}.toggle-button.jsx-9da746811b087e7c .label.jsx-9da746811b087e7c{padding-left:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding-bottom:2px}.toggle-button.disabled.jsx-9da746811b087e7c{pointer-events:none;-webkit-filter:grayscale(100%);filter:grayscale(100%);opacity:.5}.toggle-button.small.jsx-9da746811b087e7c{height:20px}.toggle-button.small.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c{height:20px;width:36px}.toggle-button.small.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .circle.jsx-9da746811b087e7c{height:15px;width:15px;top:1.5px;left:0}.toggle-button.checked.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .circle.jsx-9da746811b087e7c{-webkit-transform:translatex(-webkit-calc(100% + 2.5px));-moz-transform:translatex(-moz-calc(100% + 2.5px));-ms-transform:translatex(calc(100% + 2.5px));-o-transform:translatex(calc(100% + 2.5px));transform:translatex(-webkit-calc(100% + 2.5px));transform:translatex(-moz-calc(100% + 2.5px));transform:translatex(calc(100% + 2.5px))}.toggle-button.checked.jsx-9da746811b087e7c .toggle.jsx-9da746811b087e7c .lines.jsx-9da746811b087e7c .line.jsx-9da746811b087e7c{border-color:rgba(255,255,255,.2)}@-webkit-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@-moz-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@-o-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}");h.__hash="9da746811b087e7c";class u extends r.Component{get lightColor(){return this.props.lightColor||c.Z.theme.toggleBg}get mediumColor(){return this.props.mediumColor||c.Z.theme.toggleLine}get darkColor(){return this.props.darkColor||c.Z.theme.toggleActive}get backgroundColor(){return this.props.backgroundColor||c.Z.theme.toggleKnob}get toggleStyle(){return this.props.checked?{backgroundColor:(0,d.Tr)(this.darkColor),borderColor:(0,d.Tr)(this.darkColor)}:{backgroundColor:(0,d.Tr)(this.lightColor),borderColor:(0,d.Tr)(this.mediumColor)}}get circleStyle(){return this.props.checked?{backgroundColor:(0,d.Tr)(this.backgroundColor),borderColor:(0,d.Tr)(this.darkColor)}:{backgroundColor:(0,d.Tr)(this.backgroundColor),borderColor:"rgba(196, 174, 214, 1)"}}componentDidUpdate(e){e.checked!==this.props.checked&&this.setState({checked:this.props.checked})}render(){let e=(0,d.Bl)(this.props),t=[this.props.className];return t.push("toggle-button"),this.props.checked&&t.push("checked"),this.props.enabled||t.push("disabled"),(0,o.jsxs)("div",{style:{...this.colors,...this.props.style},...e,onClick:()=>{this.toggle()},className:"jsx-".concat(h.__hash)+" "+(t.join(" ")||""),children:[(0,o.jsxs)("div",{style:this.toggleStyle,"data-tip-anchor":!0,className:"jsx-".concat(h.__hash)+" toggle",children:[(0,o.jsx)("div",{style:this.circleStyle,className:"jsx-".concat(h.__hash)+" circle"}),this.props.isProcessing&&(0,o.jsxs)("div",{className:"jsx-".concat(h.__hash)+" lines",children:[(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"}),(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" line"})]})]}),this.props.label&&(0,o.jsx)("div",{className:"jsx-".concat(h.__hash)+" label",children:this.props.label}),(0,o.jsx)(n(),{id:h.__hash,children:h})]})}constructor(...e){super(...e),(0,s.Z)(this,"toggle",()=>{let e=!this.props.checked;this.props.onChange&&this.props.onChange(e)})}}(0,s.Z)(u,"defaultProps",{enabled:!0,checked:!1,lightColor:null,mediumColor:null,darkColor:null,backgroundColor:null});var m=(0,l.observer)(u)},45956:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var s=i(67294);function o(e,t){let{url:i,options:o={async:!0,defer:!0,crossOrigin:null,referrerPolicy:null}}=t,a=(0,s.useRef)();(0,s.useEffect)(()=>{let t=!0,s=document.createElement("script");function n(){t&&(a.current=e())}return s.async=o.async,s.defer=o.defer,o.crossOrigin&&(s.crossOrigin=o.crossOrigin),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),s.setAttribute("charset","utf-8"),s.type="text/javascript",s.readyState?s.onreadystatechange=()=>{("loaded"===s.readyState||"complete"===s.readyState)&&(s.onreadystatechange=null,n())}:s.onload=n,s.src=i,document.body.appendChild(s),()=>{t=!1,document.body.removeChild(s),a.current&&a.current()}},[])}},4392:function(e,t,i){"use strict";i.r(t),i.d(t,{__N_SSP:function(){return tP},default:function(){return t_}});var s,o,a,n,r=i(85893),l=i(67294),d=i(12918),c=i.n(d),h=i(68949),u=i(71217),m=i(81272),p=i(39214),b=i(63237),x=i(29620),g=i(84966),f=i(8231),w=i(21333),y=i(36465),v=i.n(y),k=i(5184),j=i(67814),z=i(86351),S=i(72539),C=i(16855),A=i(41333),M=i(53804),P=i(77185);function _(e){var t,i,s,o;let{user:a,album:n}=e,[d,c]=(0,l.useState)((null===(t=n.settings)||void 0===t?void 0:null===(i=t.sorting)||void 0===i?void 0:i.method)||"exifTime"),[h,u]=(0,l.useState)((null===(s=n.settings)||void 0===s?void 0:null===(o=s.sorting)||void 0===o?void 0:o.order)||"asc"),[m,p]=(0,l.useState)(n.settings.autoEnrich),[b,x]=(0,l.useState)(!1),[g,f]=(0,l.useState)(0);return b?(0,r.jsx)("div",{style:{marginTop:30,flex:1},children:(0,r.jsx)(z.Z,{total:100,percentage:g})}):(0,r.jsxs)("div",{className:"jsx-48834363ce7b7b3b container",children:[(0,r.jsxs)("div",{className:"jsx-48834363ce7b7b3b contents",children:[(0,r.jsxs)(S.Z,{value:d,onChange:e=>c(e.target.value),style:{flex:1},children:[(0,r.jsx)("option",{value:"exifTime",className:"jsx-48834363ce7b7b3b",children:P.default.translate("album.sort.order.chronologic")}),(0,r.jsx)("option",{value:"fileName",className:"jsx-48834363ce7b7b3b",children:P.default.translate("album.sort.order.alphabetic")}),(0,r.jsx)("option",{value:"uploadOrder",className:"jsx-48834363ce7b7b3b",children:P.default.translate("album.sort.order.upload")})]}),(0,r.jsx)("div",{onClick:function(){"asc"===h?u("desc"):"desc"===h&&u("asc")},className:"jsx-48834363ce7b7b3b sortorder",children:(0,r.jsx)(j.G,{icon:k.BG,fixedWidth:!0,size:"lg",rotation:"asc"===h?0:180})})]}),(0,r.jsx)("div",{className:"jsx-48834363ce7b7b3b enrich",children:(0,r.jsxs)(C.Z,{selected:m,onChange:e=>{p(e)},style:{fontSize:20,alignItems:"flex-start"},children:[(0,r.jsx)("div",{style:{marginTop:-3},className:"jsx-48834363ce7b7b3b",children:P.default.translate("album.reset.enrich-title")}),(0,r.jsx)("div",{style:{fontSize:"1.4rem",fontWeight:"normal"},className:"jsx-48834363ce7b7b3b",children:P.default.translate("album.reset.enrich-description")})]})}),(0,r.jsxs)("div",{className:"jsx-48834363ce7b7b3b buttons",children:[(0,r.jsx)(A.Z,{className:"large",disabled:b,onClick:e.onClose,children:P.default.translate("base.cancel")}),(0,r.jsx)(A.Z,{disabled:b,className:"filled default large",onClick:function(){if(b)return;x(!0);let[e]=a.FetchJSON("".concat("https://myalbum.com/api/v2","/album/").concat(n.key,"/generate"),{method:"POST",data:{sorting:{method:d,order:h},autoEnrich:m}});e.then(e=>{let{data:t}=e;f(t.job.progress),function e(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;new Promise(e=>{let[s]=a.FetchJSON("".concat("https://myalbum.com/api/v2","/album/").concat(n.key,"/status/").concat(t));s.then(t=>{let{data:s}=t;e({result:s,errors:i})}),s.catch(t=>{e({result:{e:t},errors:i+1})})}).then(i=>{let{result:s,errors:o}=i;(null==s?void 0:s.progress)&&f(s.progress),(null==s?void 0:s.finished)&&n.reloadAndEnableEditMode(),3===o&&w.Z.Alert({title:"Error: ".concat(s.e.statusCode||0),description:JSON.stringify(s.e)}),o<3&&(null==s?void 0:s.finished)===void 0&&setTimeout(()=>{e(t,s.errors)},500)})}(t.job.id)}).catch(e=>{x(!1),w.Z.Alert({title:"Error: ".concat(e.statusCode||0),description:JSON.stringify(e)})})},children:b?(0,r.jsx)(M.Z,{foregroundColor:"rgba(var(--accentColorDarkContrastColor), 1)",backgroundColor:"rgba(var(--accentColorDarkContrastColor), 0.6)"}):P.default.translate("album.reset.title")})]}),(0,r.jsx)(v(),{id:"48834363ce7b7b3b",children:".container.jsx-48834363ce7b7b3b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.container.jsx-48834363ce7b7b3b .contents.jsx-48834363ce7b7b3b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;margin-top:40px}.container.jsx-48834363ce7b7b3b .contents.jsx-48834363ce7b7b3b .sortorder.jsx-48834363ce7b7b3b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;width:35px;height:35px;border:1px solid rgba(var(--inputBorder),1);-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;margin-top:2px;margin-left:5px;cursor:pointer}.container.jsx-48834363ce7b7b3b .enrich.jsx-48834363ce7b7b3b{margin-top:15px}.container.jsx-48834363ce7b7b3b .buttons.jsx-48834363ce7b7b3b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;width:100%;margin-top:40px}"})]})}var T=i(77764),Z=i(8181),L=i(30128),D=i(18590),N=i(70198),I=i(55134),B=i(1900),E=i(32991),O=i(15907),R=i(14024);let V={size:"L",booktype:"softcover"};var J=function(){let e=(0,l.useContext)(Z.Z),t=(0,L.aF)(),i=(0,l.useRef)(null),s=(0,l.useRef)(null),[o,a]=b.Z.useOpener(),[n,d]=(0,l.useState)(!1),[c,y]=(0,l.useState)(!1),[v,k]=b.Z.useOpener(),[j,z]=(0,l.useState)(!1);function S(){a(!o)}function C(){k(!v)}function A(t){e.ui.setEditMode(t),t||e.products.update()}function M(){let i=t.isLoggedIn;(0,p.H)(t,{tab:"login",loginInfoText:P.default.translate("album.bookmark.login"),registerInfoText:P.default.translate("album.bookmark.login")}).then(()=>{i?e.album.toggleBookmark():e.album.updateMe().then(()=>{e.album.setBookmark(!0)})})}function J(){0===e.content.selection.length&&e.content.items.length>e.content.indexInView&&(e.content.items[e.content.indexInView].isSelected=!0),e.content.trigger("scrollSelectionIntoView")}(0,l.useEffect)(()=>{let i=(0,h.reaction)(()=>t.isLoggedIn,()=>{e.album.updateMe(),e.products.update()});return()=>{i()}},[]);let H=(0,l.useMemo)(()=>{let t=e.products.findPhotobook(V);return t&&t.albumPageCount<=200?(0,m.O)(P.default.getLanguage(),e.products.currency,t.price/100):null},[e.products.products,P.default.language]),F=(0,l.useCallback)(()=>{z(!0)},[]),G=(0,l.useCallback)(()=>{d(!0)},[]);return(0,r.jsx)(u.Qj,{children:()=>{let l=e.album.settings.canOrder||"owner"===e.album.me.role,h=null!==H,u=[];return l&&(u.push({type:"separator"}),u.push({type:"textBlock",title:(0,r.jsx)("div",{style:{fontSize:21,whiteSpace:"nowrap",opacity:h?1:.5},children:P.default.translate("minicart.order-album-title")}),text:h?(0,r.jsxs)("div",{children:[P.default.translate("minicart.order-album-photos",{count:e.products.assetCount})," / ",P.default.translate("minicart.order-album-pages",{count:2*e.content.spreadCount})]}):(0,r.jsx)("div",{style:{opacity:.5},children:P.default.translate("minicart.less-pages-to-order",{count:2*e.content.spreadCount-198})}),readonly:!0,multiline:!0}),h&&u.push({type:"link",className:"accent",title:P.default.translate("minicart.order-album",{price:H}),href:"/shop/photobook/[album]/",as:"/shop/photobook/".concat(e.album.key,"/")})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(x.Z,{visible:e.ui.menuBarVisible,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Z.Back,{}),!e.ui.isSmallScreen&&"owner"===e.album.me.role&&(0,r.jsx)(g.Z,{label:P.default.translate("menubar.editmode-label"),onChange:A,isProcessing:e.ui.isProcessingEditMode,checked:e.ui.editMode,style:{marginLeft:15,marginRight:15},"data-tip":e.ui.editMode?P.default.translate("tooltip.deactivate-editmode"):P.default.translate("tooltip.activate-editmode"),"data-tip-align":"bottom"},"edit-toggle"),e.ui.editMode&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z.Button,{onClick:S,ref:i,children:(0,r.jsx)(f.Z,{label:P.default.translate("menubar.add-label"),icon:N.r8},"add-item")}),(0,r.jsxs)(b.Z,{roundedBorder:[!1,!1,!0,!0],isOpen:o,position:{ref:i,hAlign:"left",vAlign:"bottom",offsetY:-1},onRequestClose:()=>a(!1),children:[(0,r.jsx)(b.Z.Item,{title:P.default.translate("base.page"),onClick:()=>{e.content.createBlankPage()}}),(0,r.jsx)(b.Z.Separator,{}),(0,r.jsx)(b.Z.Item,{title:P.default.translate("base.photos-videos"),onClick:()=>{e.ui.editor.then(t=>{t.addAssetModal.show({album:e.album,to:"album"})})}}),(0,r.jsx)(b.Z.Item,{title:P.default.translate("base.text"),disabled:!(e.edit.activeSpread&&"book-cover"!==e.edit.activeSpread.viewMode),onClick:()=>{J(),e.ui.editor.then(t=>{let i=new Promise(t=>{let[i]=e.edit.activeSpread.getSuggestions({mode:"addtext"});i.catch(()=>{t([])}),i.then(e=>{t(e.suggestions)})}),s=2*e.edit.activeSpread.contentItem.index;t.textDesignModal.show({designs:i,labels:[P.default.translate("base.pagenumber",{page:s-1}),P.default.translate("base.pagenumber",{page:s})],onClose:t=>{if(t){let i=e.edit.activeSpread;i.setPages(t.data.pages),i.save()}}})})}}),(0,r.jsx)(b.Z.Item,{title:P.default.translate("base.icon"),disabled:!(e.edit.activeSpread&&"book-cover"!==e.edit.activeSpread.viewMode),onClick:()=>{J(),function(){let t="book-cover"===e.edit.activeSpread.viewMode;t||e.ui.editor.then(t=>{t.icon.picker({spread:e.edit.activeSpread,onClose:i=>{if(i){let s=e.edit.activePage;t.icon.addIconToPage(i.icon,i.tags,s)}}})})}()}})]},"edit-menu"),(0,r.jsx)(x.Z.Button,{onClick:C,ref:s,children:(0,r.jsx)(f.Z,{icon:B.b7},"add-item")}),(0,r.jsxs)(b.Z,{roundedBorder:[!1,!1,!0,!0],isOpen:v,position:{ref:s,hAlign:"left",vAlign:"bottom",offsetY:-1},onRequestClose:()=>k(!1),children:[(0,r.jsx)(b.Z.Item,{title:P.default.translate("menubar.sorting-label"),onClick:()=>y(!0)}),(0,r.jsx)(b.Z.Item,{title:P.default.translate("album.reset.title"),onClick:()=>y(!0)})]},"settings-menu")]})]},"left"),(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Z.Back,{},"shortback"),(e.album.settings.showShareOptions||"owner"===e.album.me.role)&&(0,r.jsx)(f.Z,{icon:D.Ef,className:"menu-bar-button",onClick:F},"share-button"),e.album.me.loaded&&"owner"!==e.album.me.role&&(0,r.jsx)(f.Z,{icon:e.album.me.hasBookmarked?O.xV:I.xV,className:"menu-bar-button",onClick:()=>M(),style:{color:e.album.me.hasBookmarked?"rgba(var(--accentColor), 1)":"rgba(var(--accentColorDark), 1)"}},"bookmark-icon"),(0,r.jsx)(x.Z.Cart,{items:u}),(0,r.jsx)(f.Z,{icon:E.iV,className:"menu-bar-button",onClick:G},"more-icon")]},"mobile"),(0,r.jsx)("div",{children:e.album.settings.showMyAlbumBranding&&(0,r.jsx)(x.Z.Logo,{})},"center"),(0,r.jsxs)("div",{children:[(e.album.settings.showShareOptions||"owner"===e.album.me.role)&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(f.Z,{icon:D.Ef,className:"menu-bar-button",onClick:F},"share-button")}),e.album.me.loaded&&"owner"!==e.album.me.role&&(0,r.jsx)(f.Z,{icon:e.album.me.hasBookmarked?O.xV:I.xV,onClick:()=>M(),className:"menu-bar-button",style:{color:e.album.me.hasBookmarked?"rgba(var(--accentColor), 1)":"rgba(var(--accentColorDark), 1)"}}),(0,r.jsx)(f.Z,{icon:E.iV,className:"menu-bar-button",onClick:G},"more-icon"),(0,r.jsx)(x.Z.Cart,{items:u})]},"right")]},"menubar"),n&&(0,r.jsx)(T.Z,{album:e.album.key,onClose:()=>{e.album.updateSettings(),d(!1)}}),c&&(0,r.jsxs)(w.Z.Inline,{onClose:()=>y(!1),modalStyle:{maxWidth:500},allowClose:!1,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"title",children:P.default.translate("album.reset.title")}),(0,r.jsx)("div",{className:"description",children:P.default.translate("album.reset.description")})]},"header"),(0,r.jsx)("div",{children:(0,r.jsx)(_,{onClose:()=>y(!1),user:t,album:e.album})},"content")]}),j&&(0,r.jsx)(R.Z,{onClose:()=>z(!1),subject:{key:e.album.key,type:"album"}})]})}})},H=i(29323),F=i(71269);let G=new String(".floater.jsx-d5844371c9b13c32{--size:35px;z-index:20;display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-border-radius:var(--size);-moz-border-radius:var(--size);border-radius:var(--size);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-ms-touch-action:-ms-manipulation;-ms-touch-action:manipulation;touch-action:manipulation;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;height:var(--size);background-color:rgba(37,40,43,1);padding-right:12px;padding-left:8px;color:rgba(255,255,255,1);-webkit-box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07);-moz-box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07);box-shadow:0 .1px 8px rgba(0,0,0,.08),0 .3px 7.6px rgba(0,0,0,.028),0 .5px 12.6px rgba(0,0,0,.035),0 .9px 25.2px rgba(0,0,0,.042),0 1.7px 47px rgba(0,0,0,.05),0 4px 80px rgba(0,0,0,.07)}");G.__hash="d5844371c9b13c32";var W=function(e){return(0,r.jsxs)("div",{className:"jsx-".concat(G.__hash)+" floater",children:[e.children,(0,r.jsx)(v(),{id:G.__hash,children:G})]})},U=i(14924),K=i(61946),Q=i(52081);let X=new String(".toggle-button.jsx-78a9d05fab513ade{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;height:29px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.toggle-button.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade{height:29px;width:54px;-webkit-border-radius:29px;-moz-border-radius:29px;border-radius:29px;overflow:hidden;border:1px solid transparent;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer;position:relative;z-index:11;-webkit-transition:background-color.2s ease-out,border-color.2s ease-out;-moz-transition:background-color.2s ease-out,border-color.2s ease-out;-o-transition:background-color.2s ease-out,border-color.2s ease-out;transition:background-color.2s ease-out,border-color.2s ease-out}.toggle-button.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .circle.jsx-78a9d05fab513ade{width:21px;height:21px;-webkit-border-radius:21px;-moz-border-radius:21px;border-radius:21px;border:1px solid transparent;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;top:1.5px;left:0;z-index:10;-webkit-transform:translatex(2px);-moz-transform:translatex(2px);-ms-transform:translatex(2px);-o-transform:translatex(2px);transform:translatex(2px);-webkit-transition:-webkit-transform.2s ease-out;-moz-transition:-moz-transform.2s ease-out;-o-transition:-o-transform.2s ease-out;transition:-webkit-transform.2s ease-out;transition:-moz-transform.2s ease-out;transition:-o-transform.2s ease-out;transition:transform.2s ease-out}.toggle-button.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .lines.jsx-78a9d05fab513ade{position:absolute;top:-6px;left:0px;right:0px;bottom:-6px;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;z-index:9;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;-webkit-animation:moveLines.6s linear infinite;-moz-animation:moveLines.6s linear infinite;-o-animation:moveLines.6s linear infinite;animation:moveLines.6s linear infinite}.toggle-button.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .lines.jsx-78a9d05fab513ade .line.jsx-78a9d05fab513ade{width:1px;height:100%;border-right:6px solid rgba(var(--toggleLine),.3);-webkit-transform:rotate(25deg);-moz-transform:rotate(25deg);-ms-transform:rotate(25deg);-o-transform:rotate(25deg);transform:rotate(25deg);-webkit-transform-origin:top left;-moz-transform-origin:top left;-ms-transform-origin:top left;-o-transform-origin:top left;transform-origin:top left}.toggle-button.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .lines.jsx-78a9d05fab513ade .line.jsx-78a9d05fab513ade+.line.jsx-78a9d05fab513ade{margin-left:6px}.toggle-button.jsx-78a9d05fab513ade .label.jsx-78a9d05fab513ade{padding-left:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding-bottom:2px}.toggle-button.disabled.jsx-78a9d05fab513ade{pointer-events:none;-webkit-filter:grayscale(100%);filter:grayscale(100%);opacity:.5}.toggle-button.small.jsx-78a9d05fab513ade{height:20px}.toggle-button.small.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade{height:20px;width:36px}.toggle-button.small.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .circle.jsx-78a9d05fab513ade{height:15px;width:15px}.toggle-button.checked.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .circle.jsx-78a9d05fab513ade{-webkit-transform:translatex(-webkit-calc(100% + 2.5px));-moz-transform:translatex(-moz-calc(100% + 2.5px));-ms-transform:translatex(calc(100% + 2.5px));-o-transform:translatex(calc(100% + 2.5px));transform:translatex(-webkit-calc(100% + 2.5px));transform:translatex(-moz-calc(100% + 2.5px));transform:translatex(calc(100% + 2.5px))}.toggle-button.checked.jsx-78a9d05fab513ade .toggle.jsx-78a9d05fab513ade .lines.jsx-78a9d05fab513ade .line.jsx-78a9d05fab513ade{border-color:rgba(255,255,255,.2)}@-webkit-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@-moz-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@-o-keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}@keyframes moveLines{from{margin-left:-12px}to{margin-left:0}}");X.__hash="78a9d05fab513ade";class q extends l.Component{get backgroundColor(){return this.props.backgroundColor||Q.Z.theme.toggleKnob}get toggleStyle(){return this.props.checked?{backgroundColor:"rgba(66, 172, 89, 1)"}:{backgroundColor:"rgba(230,230, 230, 1)"}}get circleStyle(){return this.props.checked?{backgroundColor:"rgba(255,255,255,1)",border:0}:{backgroundColor:"rgba(255,255,255, 1)",borderColor:"rgba(0, 0, 0, 0.4)"}}componentDidUpdate(e){e.checked!==this.props.checked&&this.setState({checked:this.props.checked})}render(){let e=(0,K.Bl)(this.props),t=[this.props.className];return t.push("toggle-button"),this.props.checked&&t.push("checked"),this.props.enabled||t.push("disabled"),(0,r.jsxs)("div",{style:{...this.colors,...this.props.style},...e,onClick:()=>{this.toggle()},className:"jsx-".concat(X.__hash)+" "+(t.join(" ")||""),children:[(0,r.jsxs)("div",{style:this.toggleStyle,"data-tip-anchor":!0,className:"jsx-".concat(X.__hash)+" toggle",children:[(0,r.jsx)("div",{style:this.circleStyle,className:"jsx-".concat(X.__hash)+" circle"}),this.props.isProcessing&&(0,r.jsxs)("div",{className:"jsx-".concat(X.__hash)+" lines",children:[(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" line"})]})]}),(0,r.jsx)("div",{className:"jsx-".concat(X.__hash)+" label",children:this.props.label}),(0,r.jsx)(v(),{id:X.__hash,children:X})]})}constructor(...e){super(...e),(0,U.Z)(this,"toggle",()=>{let e=!this.props.checked;this.props.onChange&&this.props.onChange(e)})}}(0,U.Z)(q,"defaultProps",{enabled:!0,checked:!1,backgroundColor:null});var Y=(0,H.observer)(q);let $={styles:(0,r.jsx)(v(),{id:"9c0783be240ffc7f",children:".lazylist.jsx-9c0783be240ffc7f{-ms-touch-action:-ms-none pan-up pan-down;-ms-touch-action:none pan-up pan-down;touch-action:none pan-up pan-down}"}),className:"jsx-9c0783be240ffc7f"},ee=new String(".bottom.jsx-a2ead83986c9fa49{position:fixed;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;right:0px;bottom:0px;left:0px;z-index:2000;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.bottom.jsx-a2ead83986c9fa49 div{pointer-events:auto}.bottom.jsx-a2ead83986c9fa49 .left-buttons.jsx-a2ead83986c9fa49{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-webkit-align-items:flex-end;-moz-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;padding-bottom:15px;padding-bottom:max(15px,env(safe-area-inset-bottom));padding-right:15px}.bottom.jsx-a2ead83986c9fa49 .left-buttons.jsx-a2ead83986c9fa49 .test.jsx-a2ead83986c9fa49{padding:5px 10px;background-color:white;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px}.bottom.jsx-a2ead83986c9fa49 .right-buttons.jsx-a2ead83986c9fa49{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-webkit-align-items:flex-end;-moz-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;padding-bottom:15px;padding-bottom:max(15px,env(safe-area-inset-bottom));padding-right:15px}.bottom.jsx-a2ead83986c9fa49 .right-buttons.jsx-a2ead83986c9fa49>*+*{margin-left:15px}.main-content{-ms-touch-action:-ms-none pan-up pan-down;-ms-touch-action:none pan-up pan-down;touch-action:none pan-up pan-down}");ee.__hash="a2ead83986c9fa49";var et=i(67478),ei=i(27856),es=i(96916),eo=i(45522),ea=i(5152),en=i.n(ea);let er=en()(()=>i.e(1783).then(i.bind(i,51783)),{loadableGenerated:{webpack:()=>[51783]},ssr:!1});var el=i(23302),ed=i(95228),ec=i(23927),eh=function(e){let{asset:t}=e;if(!t)return null;let i=t.sizes.map(e=>e.url),s=i.slice(-1)[0];return(0,r.jsx)(ec.Z,{onClose:e.onClose,width:428,children:(0,r.jsxs)("div",{className:"content",children:[(0,r.jsx)("h1",{children:P.default.translate("default.share")}),(0,r.jsx)(ed.Z,{url:s,showLink:!1,size:49}),"photo"===t.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{height:50}}),(0,r.jsx)(el.Z,{urls:i.slice(-3).reverse()})]})]})})},eu=i(89227),em=i(26525),ep=i.n(em),eb=i(71619),ex=i(92746);let eg=(0,H.observer)(function(e){var t,i,s,o,a;let{layer:n,page:d,contentItem:c,spread:u,event:m,isOpen:p,onRequestClose:x}=e,g=(0,l.useContext)(Z.Z),f=[],w=g.ui.editMode,y=n?d.getLayerByMetaName(n).get():null,v=(null==y?void 0:null===(t=y.style)||void 0===t?void 0:t.content)!==void 0?y.style.content.asset:void 0,k=g.album.settings.showShareOptions||"owner"===g.album.me.role,j=v?void 0!==v.meta&&void 0!==v.meta.editType?v.meta.editType:v.type:"layer",[z,S]=(0,l.useState)(!1),[C,A]=(0,l.useState)(!1),M="owner"===g.album.me.role&&!g.user.subscription.features.download,[_,T]=(0,l.useState)(!1),L=(0,l.useCallback)(e=>{M?T(!0):g.album.downloadAsset(e)},[M]),D=(0,l.useCallback)(()=>{T(!1)},[]),N=(0,l.useCallback)(()=>{c.delete(),A(!1)},[c]);if(v){(null==v?void 0:v.type)==="text"&&f.push({type:"item",title:P.default.translate("context.copy-text"),onClick:()=>{navigator.clipboard.writeText(ep()(v.text)).then(()=>console.log("Copied to clipboard")).catch(e=>console.error(e))}}),k&&["photo","video"].includes(null==v?void 0:v.type)&&f.push({type:"item",title:P.default.translate("default.share")+"...",onClick:()=>{S(v)}});let e=g.album.settings.canDownload||"owner"===g.album.me.role;g.album.canDownloadAsset(v)&&e&&f.push({type:"item",title:P.default.translate("context.download-original"),onClick:()=>{L(v.key)}})}if(w){if(f.length>0&&f.push({type:"separator"}),(null==y?void 0:null===(i=y.meta)||void 0===i?void 0:i.editable)&&v&&"page"===d.design.type&&"text"===v.type){let e=y.meta.draggable&&y.meta.resizable;f.push({type:"checkmark",checked:e,title:P.default.translate("context.free-move"),closeOnClick:!0,onClick:()=>{let t={...y.meta};t.resizable=!e,t.draggable=!e,d.setLayerProperty({layer:n,path:["meta"],value:t})}})}let e=(null==y?void 0:null===(s=y.meta)||void 0===s?void 0:s.editable)&&(null==y?void 0:null===(o=y.meta)||void 0===o?void 0:o.deletable)!==!1||(null==y?void 0:null===(a=y.meta)||void 0===a?void 0:a.deletable)===!0;e&&f.push({type:"item",title:P.default.translate("context.delete-"+j),onClick:()=>{g.ui.editMode&&(g.content.selection=[c],(0,h.runInAction)(()=>{g.edit.activeTab="page"}),g.ui.editor.then(e=>{e.removeLayer(n,d,u)}))}}),void 0!==c&&c.isDeletable&&f.push({type:"item",title:P.default.translate("context.delete-page",{page:c.label?" "+c.label:""}),onClick:()=>{A(!0)}})}return g.user.isAdmin&&(f.length>0&&"separator"!==f.slice(-1)[0].type&&f.push({type:"separator"}),f.push({type:"item",title:"Show print version",onClick:()=>{window.open("/album/"+g.album.key+"/print/?spread="+u.key)}})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{isOpen:p,position:{event:m},onRequestClose:x,children:f.length>0&&b.Z.ArrayItems(f)}),(0,r.jsx)(eh,{asset:z,onClose:()=>S(!1)}),_&&(0,r.jsx)(eu.Z,{onClose:D}),C&&(0,r.jsx)(eb.Z,{title:P.default.translate("context.delete-page",{page:c.label?" "+c.label:""}),text:P.default.translate("context.delete-page-confirmation-msg",{page:c.label?" "+c.label:""}),confirmLabel:P.default.translate("base.delete"),onConfirm:N,onCancel:()=>{A(!1)}})]})});var ef=(0,l.memo)(function(e){let{chat:t}=(0,eo.q)(),i=(0,l.useContext)(Z.Z),[s,o]=(0,l.useState)(!1),[a,n]=(0,l.useState)({isOpen:!1,layer:void 0,page:void 0,event:void 0,contentItem:void 0,spread:void 0}),d=(0,l.useRef)(null),c=(0,l.useRef)([]),m=(0,l.useRef)(null),p=(0,l.useRef)(null),b=(0,l.useRef)(null),x=(0,ei.D)(24,()=>{d.current&&null!==b.current&&(d.current.autoScrollToIndex(Math.max(0,b.current)),b.current=null,(0,h.runInAction)(()=>{i.content.selectionIsInView=!0}))},{atBegin:!0});(0,l.useEffect)(()=>(i.content.indexInView=0,i.content.on("scrollSelectionIntoView",N),i.content.on("scrollIndexIntoView",I),i.content.on("scrollToTop",B),i.content.on("contextmenu",E),i.content.on("longtouch",g),i.content.on("createBlankPage",_),window.addEventListener("keydown",y,{passive:!0}),window.addEventListener("mousedown",w,{passive:!0}),et.Z&&(window.lazylist=d),c.current.push((0,h.reaction)(()=>i.ui.editMode,e=>{if(d.current){let t=d.current.index;if(b.current=t,e){let e=i.content.items[t];e&&(i.content.selection=[e])}else i.content.deSelectAll();d.current.autoScrollToIndex(Math.max(0,t))}})),o(!0),function(){for(let e of c.current)e();p.current&&p.current.dispose(),i.content.off("scrollSelectionIntoView",N),i.content.off("scrollIndexIntoView",I),i.content.off("scrollToTop",B),i.content.off("contextmenu",E),i.content.off("longtouch",g),i.content.off("createBlankPage",_),window.removeEventListener("keydown",y,{passive:!0}),window.removeEventListener("mousedown",w,{passive:!0}),et.Z&&delete window.lazylist}),[]);let g=(0,l.useCallback)(e=>{!i.ui.editMode&&i.ui.menuBarEnabled&&n({isOpen:!0,event:e.event,layer:e.layer,page:e.page,contentItem:e.contentItem,spread:e.spread})},[]),f=(0,l.useCallback)(()=>{n({...a,isOpen:!1})},[a]),w=(0,l.useCallback)(e=>{i.ui.editMode&&e.target&&e.target.classList.contains("spread-spacer")&&i.content.deSelectAll()},[]),y=(0,l.useCallback)(e=>{let t,s;let o=d.current.index;switch(e.keyCode){case 27:e.target===document.body&&i.content.deSelectAll();break;case 33:e.preventDefault(),(t=(s=o-1)>-1?i.content.items[s]:null)&&(i.ui.editMode&&(i.content.selection=[t]),d.current.scrollToIndex(s));break;case 34:e.preventDefault(),s=o+1,(t=i.content.items.length-1>s?i.content.items[s]:null)&&(i.ui.editMode&&(i.content.selection=[t]),d.current.scrollToIndex(s))}},[]),k=(0,l.useCallback)(e=>e.content,[]),j=(0,l.useCallback)(()=>{let e=0;return i.ui.editMode&&(e+=230),(0,r.jsx)("div",{style:{height:e}})},[i.ui.editMode]),z=(0,l.useCallback)(e=>{if(d.current)return e.touchLayout(),e.size},[]),S=(0,l.useCallback)(e=>{i.ui.setDimensions(e)},[]),C=(0,l.useRef)((0,ei.P)(100,()=>{A()})).current,A=(0,l.useCallback)(()=>{null===b.current&&d.current&&(i.content.indexInView=d.current.index,i.ui.editMode&&i.content.selection.length>0&&(0,h.runInAction)(()=>{let e=d.current.indexesInViewport,t=e.includes(i.content.selection[0].index);i.content.selectionIsInView=t}))},[]),M=(0,l.useCallback)(e=>{let t=i.ui.viewMode,s=i.ui.isSmallScreen?["book","smallscreen"]:["book","fill"],o=s.indexOf(t);return e?o<s.length-1&&o++:o>0&&o--,s[o]},[]);function _(){let e=d.current.index>0?d.current.index-1:0,t=i.content.items[e].key;i.content.addSpread({insertAfter:t}).then(e=>{i.content.selection=[e]}).catch(()=>{})}let T=(0,l.useCallback)(e=>{i.ui.lockMenuBar=!0,d.current.autoScrollToIndex(Math.max(0,d.current.index)),(0,h.runInAction)(()=>{i.ui.viewMode=M(e)}),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{i.ui.lockMenuBar=!1},300)},[]),L=(0,l.useCallback)(()=>{T(!1)},[]),D=(0,l.useCallback)(()=>{T(!0)},[]),N=(0,l.useCallback)(()=>{d.current&&d.current.scrollIntoView(i.content.selection[0].index,{before:265,after:i.ui.editBarHeight+200})},[]),I=(0,l.useCallback)(e=>{d.current&&d.current.scrollIntoView(e.index,{before:265,after:i.ui.editBarHeight+200})},[]),B=(0,l.useCallback)(()=>{d.current&&d.current.scrollToIndex(1,!0)},[]),E=(0,l.useCallback)(e=>{e.event.preventDefault(),n({isOpen:!0,event:e.event,page:e.page,layer:e.layer,contentItem:e.contentItem,spread:e.spread})},[]);return(0,r.jsx)(u.Qj,{children:()=>{let o=i.content.items.slice();p.current&&p.current.dispose(),(0,h.autorun)(e=>{p.current=e;let t=0;for(let e of o)t+=e.layout.width+e.layout.height;t+=i.ui.editMode,d.current&&(d.current.updateVisibleItems(),x())},{delay:20});let n="25,26,27",l="255,255,255",c=[193,147,254];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"relative",...e.style},className:"jsx-".concat(ee.__hash)+" "+v().dynamic([["b2a057e7e92ef03e",[i.ui.editMode?"none":"invalid-value"]],["5558c609f0311c22",[n,l,c]]]),children:(0,r.jsx)(F.Z,{ref:d,data:o,viewportOffset:{before:65,after:230},renderItem:k,getItemLayout:z,className:$.className+" "+(i.content.selection.length>0?"selection":""),onResize:S,onScroll:C,ListFooterComponent:j},"spreads-"+i.storeInstanceId)}),(0,r.jsx)(ex.Z,{}),(0,r.jsx)(eg,{...a,onRequestClose:f}),(0,r.jsx)(er,{}),(0,r.jsxs)("div",{className:"jsx-".concat(ee.__hash)+" "+v().dynamic([["b2a057e7e92ef03e",[i.ui.editMode?"none":"invalid-value"]],["5558c609f0311c22",[n,l,c]]])+" bottom",children:[(0,r.jsxs)("div",{className:"jsx-".concat(ee.__hash)+" "+v().dynamic([["b2a057e7e92ef03e",[i.ui.editMode?"none":"invalid-value"]],["5558c609f0311c22",[n,l,c]]])+" right-buttons",children:[(i.ui.editMode||t.isChatting)&&(0,r.jsx)(es.Z,{}),s&&i.ui.showViewModePicker&&(0,r.jsx)(W,{children:(0,r.jsx)(Y,{className:"small",label:P.default.translate("album.view-as-photobook"),checked:"book"===i.ui.viewMode,darkColor:[66,172,89],onChange:()=>{"book"===i.ui.viewMode?D():L()}})})]}),Object.values(i.ui.components)]}),(0,r.jsx)(v(),{id:"5558c609f0311c22",dynamic:[n,l,c],children:":root{--albumBackgroundColor:".concat(n,";--albumForegroundColor:").concat(l,";--albumSelection:").concat(c,"}body{background-color:rgba(var(--albumBackgroundColor),1)}")}),(0,r.jsx)(v(),{id:ee.__hash,children:ee}),(0,r.jsx)(v(),{id:"b2a057e7e92ef03e",dynamic:[i.ui.editMode?"none":"invalid-value"],children:"*:not([contenteditable]):not(input):not(textarea):not(.rte):not([contenteditable] *){-webkit-user-select:".concat(i.ui.editMode?"none":"invalid-value",";-moz-user-select:").concat(i.ui.editMode?"none":"invalid-value",";-ms-user-select:").concat(i.ui.editMode?"none":"invalid-value",";user-select:").concat(i.ui.editMode?"none":"invalid-value","}@media(hover:none){*:not([contenteditable]):not(input):not(textarea):not(.rte):not([contenteditable] *){-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}}")}),$.styles]})}})}),ew=i(9008),ey=i.n(ew),ev=i(2962);function ek(e){var t;let{album:i}=e,s=i.title,o=void 0!==i.thumbs&&null!==i.thumbs&&Object.keys(i.thumbs).length>0?function(e){let t={width:1200,height:800},i={url:"",width:0,height:0};return e.forEach(e=>{(e.width>=i.width&&i.width<=t.width||e.height>=i.height&&i.height<=t.height)&&(i.url=e.url,i.width=e.width,i.height=e.height)}),i}(i.thumbs.landscape.sizes):null,a="".concat("https://myalbum.com","/album/").concat(i.key,"/"),n=!1===i.settings.searchIndexEnabled||(null===(t=i.access)||void 0===t?void 0:t.level)==="private";return(0,r.jsx)(u.Qj,{children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ev.PB,{title:s,description:" ",noindex:n,nofollow:n,openGraph:{title:s,description:" ",url:a,images:[{url:null==o?void 0:o.url,width:null==o?void 0:o.width,height:null==o?void 0:o.height}]},twitter:{handle:i.seo.twitter}}),(0,r.jsx)(ej,{ua:i.seo.analytics})]})})}function ej(e){if(!e.ua)return null;let t="\n    function loadCustomGa()\n    {\n      if(window.gtag)\n        gtag('config', '".concat(e.ua,"', {'anonymize_ip': true, 'send_page_view': false});\n      else\n        setTimeout(function () {\n          loadCustomGa();\n        }, 100);\n    }\n\n    loadCustomGa();\n  ");return(0,r.jsx)("script",{async:!0,dangerouslySetInnerHTML:{__html:t}})}var ez=function(){let e=(0,l.useContext)(Z.Z);return(0,r.jsx)(u.Qj,{children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ey(),{children:(0,r.jsx)("title",{children:e.album.title})}),(0,r.jsx)(ek,{album:e.album})]})})},eS=i(63163),eC=i(11163),eA=i.n(eC),eM=i(72517);(0,u.DT)(!1);var eP=class{hydrate(e){e&&(this.key=e.key,this.title=e.title,this.lastActivity=new Date(e.lastActivity),this.access=e.access,this.thumbs=e.thumbs,this.seo=e.seo?e.seo:{},e.settings&&(this.settings=Object.assign({},this.settings,e.settings)))}updateMe(){let[e]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+this.key+"/me");return e.then(e=>{(0,h.runInAction)(()=>{this.me={...e.data,loaded:!0}})}),e}updateSettings(){let[e]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+this.key+"/settings");e.then(e=>{(0,h.runInAction)(()=>{Object.assign(this.settings,{...e.data})})}).catch(()=>{})}toggleBookmark(){this.setBookmark(!this.me.hasBookmarked)}setBookmark(e){if("owner"===this.me.role)return;let t=this.me.hasBookmarked;this.me.hasBookmarked=e;let[i]=this.store.user.FetchJSON("".concat("https://myalbum.com/api/v2","/album/").concat(this.key,"/bookmark"),{method:e?"POST":"DELETE"});i.then(()=>{this.updateMe()}).catch(e=>{console.error(e),this.me.hasBookmarked=t})}get canDownload(){let e=this.store.user.subscription.features.download,t="owner"===this.me.role;return this.settings.canDownload||t&&e}get canContribute(){return"owner"!==this.me.role&&this.settings.canContribute}canDownloadAsset(e){switch(e.type){case"photo":case"video":return!0;default:return!1}}downloadAsset(e){let[t]=this.store.user.FetchJSON("".concat("https://myalbum.com/api/v2","/album/").concat(this.key,"/asset/").concat(e,"/download"));t.then(e=>{e.data.url&&(0,eM.Sv)(e.data.url)}).catch(e=>console.error(e))}reloadAndEnableEditMode(){eA().replace(eA().asPath).then(()=>{this.store.assets.reloadAll()})}constructor(e,t){(0,U.Z)(this,"key",""),(0,U.Z)(this,"title",""),(0,U.Z)(this,"lastActivity",new Date(0)),(0,U.Z)(this,"me",{loaded:!1,role:"guest",hasBookmarked:!1}),(0,U.Z)(this,"access",{level:"hidden"}),(0,U.Z)(this,"seo",{}),(0,U.Z)(this,"thumbs",{}),(0,U.Z)(this,"settings",{showContributors:!1,showBookmarkers:!1,showAnimations:!1,showShareOptions:!1,showMyAlbumBranding:!1,searchIndexEnabled:!1,canOrder:!1,canComment:!1,canLike:!1,canDownload:!1,canContribute:!1}),(0,h.makeObservable)(this,{key:h.observable,title:h.observable,me:h.observable.deep,settings:h.observable,hydrate:h.action,setBookmark:h.action,canDownload:h.computed,canContribute:h.computed}),this.store=e,this.hydrate(t),this.updateMe()}};(0,u.DT)(!1);var e_=class{get sortedItems(){return this.items.slice().sort((e,t)=>{switch(this.sortBy){case"date":return e.dateTime-t.dateTime?1:-1;case"batch":if(e.batchNr===t.batchNr)return e.dateTime>t.dateTime?1:-1;return e.batchNr>t.batchNr?1:-1;case"filename":if(e.fileName&&t.fileName)return e.fileName.localeCompare(t.fileName,void 0,{numeric:!0,sensitivity:"base"});if(e.batchNr===t.batchNr)return e.dateTime>t.dateTime?1:-1;return e.batchNr>t.batchNr?1:-1;default:return 0}})}constructor(e,t){(0,U.Z)(this,"url",""),(0,U.Z)(this,"items",[]),(0,U.Z)(this,"isLoading",0),(0,U.Z)(this,"sortBy","date"),(0,U.Z)(this,"add",e=>{let t=this.getByKey(e.key);return t||this.items.push(e),t}),(0,U.Z)(this,"addBatch",e=>{(0,h.transaction)(()=>{for(let t in e){let i={...e[t]};this.add(i)}})}),(0,U.Z)(this,"getIndex",e=>this.items.findIndex(t=>t.key===e)),(0,U.Z)(this,"getByKey",e=>{let t=this.getIndex(e);return this.items[t]}),(0,U.Z)(this,"delete",e=>{("string"!=typeof e||(e=this.getByKey(e)))&&this.items.remove(e)}),(0,U.Z)(this,"reloadAll",()=>(this.loadAllPromise=void 0,this.loadAll())),(0,U.Z)(this,"loadAll",e=>{if(this.loadAllPromise)return this.loadAllPromise;void 0===e&&(e=this.url+"?length=100&start=0");let t=[],i=e=>new Promise(s=>{this.load(e).then(e=>{let{url:o,assets:a}=e;t=t.concat(a),o?i(o).then(()=>{s()}):s()})});return this.loadAllPromise=new Promise(s=>{i(e).then(()=>{(0,h.runInAction)(()=>{this.items.replace(t)}),s()})}),this.loadAllPromise}),(0,U.Z)(this,"load",e=>(this.isLoading++,new Promise(t=>{let[i]=this.store.user.FetchJSON(e);i.then(e=>{t({url:e.data.links.next,assets:e.data.assets}),(0,h.runInAction)(()=>{this.isLoading--})}).catch(e=>{console.warn(e),(0,h.runInAction)(()=>{this.isLoading--})})}))),(0,U.Z)(this,"hydrate",e=>{e&&(this.url=e.url)}),(0,h.makeObservable)(this,{url:h.observable,items:h.observable.shallow,isLoading:h.observable,sortBy:h.observable,add:h.action,addBatch:h.action,delete:h.action,load:h.action}),this.store=e,this.hydrate(t)}},eT=i(57632);let eZ=[],eL={};function eD(e){return{lineHeight:e.lineHeight,vAlign:"bottom",textAlign:"left",font:e.font,fontSize:e.fontSize,p:{marginTop:20},ol:{marginTop:20},ul:{marginTop:20},li:{marginLeft:30,marginTop:0},h1:{font:e.title.font,fontSize:1*e.title.fontSize,lineHeight:1.25*e.title.fontSize},h2:{font:e.title.font,fontSize:.75*e.title.fontSize,lineHeight:.9375*e.title.fontSize},h3:{font:e.title.font,fontSize:.625*e.title.fontSize,lineHeight:.78125*e.title.fontSize},h4:{font:e.title.font,fontSize:.5*e.title.fontSize,lineHeight:.625*e.title.fontSize},h5:{font:e.title.font,fontSize:.437*e.title.fontSize,lineHeight:.54625*e.title.fontSize},h6:{font:e.title.font,fontSize:.425*e.title.fontSize,lineHeight:.53125*e.title.fontSize,opacity:.5},a:{textDecoration:"underline"},em:{font:e.em.font}}}eL.default=eD({title:{font:{family:"Source Sans Pro",style:"normal",weight:200},fontSize:32},font:{family:"Roboto Slab",style:"normal",weight:200},em:{font:{family:"Roboto",style:"italic",weight:100}},fontSize:18,lineHeight:25}),eL.SacramentoPiazzolla=eD({title:{font:{family:"Sacramento",style:"normal",weight:400},fontSize:42},font:{family:"Piazzolla",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Piazzolla",style:"italic",weight:300}}}),eL.MontserratPiazzolla=eD({title:{font:{family:"Montserrat",style:"normal",weight:900},fontSize:24},font:{family:"Piazzolla",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Piazzolla",style:"italic",weight:300}}}),eL.PiazzollaRoboto=eD({title:{font:{family:"Piazzolla",style:"normal",weight:600},fontSize:30},font:{family:"Roboto",style:"normal",weight:100},fontSize:18,lineHeight:25,em:{font:{family:"Roboto",style:"italic",weight:100}}}),eL.SatisfyPiazzolla=eD({title:{font:{family:"Satisfy",style:"normal",weight:400},fontSize:36},font:{family:"Piazzolla",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Piazzolla",style:"italic",weight:400}}}),eL.OpenSansCondensedPiazzolla=eD({title:{font:{family:"Open Sans Condensed",style:"normal",weight:700},fontSize:36},font:{family:"Piazzolla",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Piazzolla",style:"italic",weight:400}}}),eL.GelasioRoboto=eD({title:{font:{family:"Gelasio",style:"normal",weight:400},fontSize:30},font:{family:"Roboto",style:"normal",weight:100},fontSize:18,lineHeight:25,em:{font:{family:"Roboto",style:"italic",weight:100}}}),eL.ElsieRoboto=eD({title:{font:{family:"Elsie",style:"normal",weight:400},fontSize:30},font:{family:"Roboto",style:"normal",weight:100},fontSize:18,lineHeight:25,em:{font:{family:"Roboto",style:"italic",weight:100}}}),eL.RobotoCondensedCabin=eD({title:{font:{family:"Roboto Condensed",style:"normal",weight:700},fontSize:30},font:{family:"Cabin",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Cabin",style:"italic",weight:400}}}),eL.OpenSansCondensedCantarell=eD({title:{font:{family:"Open Sans Condensed",style:"normal",weight:700},fontSize:30},font:{family:"Cantarell",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Cantarell",style:"italic",weight:400}}}),eL.PermanentMarkerOverpass=eD({title:{font:{family:"Permanent Marker",style:"normal",weight:400},fontSize:27},font:{family:"Overpass",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Overpass",style:"italic",weight:400}}}),eL.OpenSansCondensedJosefinSans=eD({title:{font:{family:"Open Sans Condensed",style:"normal",weight:700},fontSize:36},font:{family:"Josefin Sans",style:"normal",weight:300},fontSize:18,lineHeight:25,em:{font:{family:"Josefin Sans",style:"italic",weight:300}}}),eL.MontserratJosefinSans=eD({title:{font:{family:"Montserrat",style:"normal",weight:900},fontSize:24},font:{family:"Josefin Sans",style:"normal",weight:300},fontSize:18,lineHeight:25,em:{font:{family:"Josefin Sans",style:"italic",weight:300}}}),eL.SatisfyGelasio=eD({title:{font:{family:"Satisfy",style:"normal",weight:400},fontSize:36},font:{family:"Gelasio",style:"normal",weight:400},fontSize:18,lineHeight:25,em:{font:{family:"Gelasio",style:"italic",weight:400}}}),eL.LibreBaskervilleMontserrat=eD({title:{font:{family:"Libre Baskerville",style:"normal",weight:400},fontSize:24},font:{family:"Montserrat",style:"normal",weight:300},fontSize:18,lineHeight:25,em:{font:{family:"Montserrat",style:"italic",weight:300}}}),eZ.push({name:"base.default",styleSheet:"default"}),eZ.push({name:"Sacramento Piazzolla",styleSheet:"SacramentoPiazzolla"}),eZ.push({name:"Montserrat Piazzolla",styleSheet:"MontserratPiazzolla"}),eZ.push({name:"Piazzolla Roboto",styleSheet:"PiazzollaRoboto"}),eZ.push({name:"Satisfy Piazzolla",styleSheet:"SatisfyPiazzolla"}),eZ.push({name:"OpenSansCondensed Piazzolla",styleSheet:"OpenSansCondensedPiazzolla"}),eZ.push({name:"Gelasio Roboto",styleSheet:"GelasioRoboto"}),eZ.push({name:"Elsie Roboto",styleSheet:"ElsieRoboto"}),eZ.push({name:"RobotoCondensed Cabin",styleSheet:"RobotoCondensedCabin"}),eZ.push({name:"OpenSansCondensed Cantarell",styleSheet:"OpenSansCondensedCantarell"}),eZ.push({name:"PermanentMarker Overpass",styleSheet:"PermanentMarkerOverpass"}),eZ.push({name:"OpenSansCondensed JosefinSans",styleSheet:"OpenSansCondensedJosefinSans"}),eZ.push({name:"Montserrat JosefinSans",styleSheet:"MontserratJosefinSans"}),eZ.push({name:"Satisfy Gelasio",styleSheet:"SatisfyGelasio"}),eZ.push({name:"LibreBaskerville Montserrat",styleSheet:"LibreBaskervilleMontserrat"}),(0,u.DT)(!1);var eN=class{get viewMode(){return this.editMode?"book":this._viewMode}set viewMode(e){this._viewMode=e}get showViewModePicker(){return!this.editMode}setWindowSize(e){let t=this.isSmallScreen,i=e.clientWidth<700;i?this.isSmallScreen||(this.oldViewMode=this.viewMode,this.viewMode="smallscreen"):t&&(this.viewMode=this.oldViewMode?this.oldViewMode:this.defaultViewMode),this.isSmallScreen=i,this.window=e}setMousePosition(e){Object.assign(this.mouse,{...e}),e.clientY<=60&&(this.menuBarVisible=!0)}setScrollPosition(e){e.scrollTop=e.scrollTop>0?e.scrollTop:0;let t=e.scrollTop===this.scrollTop?this.scrollDirection:e.scrollTop>this.scrollTop?"down":"up";this.scrollDirection=t,this.scrollTop=e.scrollTop;let i=this.mouse.clientY<=60,s="down"!==t||!!i||e.scrollTop+65<this.window.innerHeight;this.editMode||this.lockMenuBar||(this.menuBarVisible=s),this.window.scrollTop=e.scrollTop}resize(){let e=this.isSmallScreen,t=document.documentElement.clientWidth<700;t?this.isSmallScreen||(this.oldViewMode=this.viewMode,this.viewMode="smallscreen"):e&&(this.viewMode=this.oldViewMode?this.oldViewMode:this.defaultViewMode),this.isSmallScreen=t}setDimensions(e){this.dimensions=e}getSeperatorLayout(e){let t=Math.round(Math.max(this.seperator.min,Math.min(this.seperator.max,e*this.seperator.scale))),i=0;return i="smallscreen"===this.viewMode?2*t:t,this.editMode&&(i=t),{width:t,height:i}}toggleEditMode(){this.setEditMode(!this.editMode)}setEditMode(e){return(!e&&this._isEditModeAuthenticating&&((0,p.yW)(),this._isEditModeAuthenticating=!1),e===this.editMode)?Promise.resolve(e):new Promise(t=>{(0,h.runInAction)(()=>{this.isProcessingEditMode=!0}),new Promise((t,i)=>{e?(this._isEditModeAuthenticating=!0,(0,p.H)(this.store.user,{tab:"login"}).then(()=>{if(this._isEditModeAuthenticating=!1,"owner"!==this.store.album.me.role)return console.warn("Owner role needed to enable editMode"),i("Owner role required to enable editMode");t()}).catch(e=>{this._isEditModeAuthenticating=!1,i(e)})):t()}).then(()=>{new Promise(t=>{e?((0,h.runInAction)(()=>{this.menuBarVisible=!0}),this.editor.then(()=>{t(e)})):t(e)}).then(()=>{(0,h.runInAction)(()=>{this.lockMenuBar=!0,this.editMode=e,this.interactive=!e}),t(e)}),this._editModeLockMenubarTimer&&clearTimeout(this._editModeLockMenubarTimer),this._editModeLockMenubarTimer=setTimeout(()=>{this.lockMenuBar=!1},300)}).catch(()=>{t(this.editMode)})}).finally(()=>{(0,h.runInAction)(()=>{this.isProcessingEditMode=!1})})}get editor(){return new Promise(e=>{void 0===this._editor&&(this._editor=new Promise(e=>{Promise.all([i.e(1193),i.e(6572)]).then(i.bind(i,76572)).then(t=>{let i=new t.default(this.store);e(i)})})),this._editor.then(e)})}addComponent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,eT.Z)();return this.components[t]=e,e}removeComponentByKey(e){void 0!==this.components[e]&&delete this.components[e]}dispose(){this._editor&&this._editor.then(e=>{e.dispose()})}constructor(e,t){(0,U.Z)(this,"window",{innerWidth:1600,innerHeight:1200,clientWidth:1600,scrollTop:0}),(0,U.Z)(this,"mouse",{clientY:0,clientX:0}),(0,U.Z)(this,"_viewMode","fill"),(0,U.Z)(this,"defaultViewMode","fill"),(0,U.Z)(this,"oldViewMode",void 0),(0,U.Z)(this,"isSmallScreen",!1),(0,U.Z)(this,"ratio",1.35),(0,U.Z)(this,"interactive",!0),(0,U.Z)(this,"seperatorSize",50),(0,U.Z)(this,"seperator",{max:1e3,min:10,scale:.05}),(0,U.Z)(this,"styleSheet",{}),(0,U.Z)(this,"muted",!1),(0,U.Z)(this,"lockMenuBar",!1),(0,U.Z)(this,"menuBarEnabled",!0),(0,U.Z)(this,"menuBarVisible",!0),(0,U.Z)(this,"scrollTop",0),(0,U.Z)(this,"editMode",!1),(0,U.Z)(this,"isProcessingEditMode",!1),(0,U.Z)(this,"components",{}),(0,U.Z)(this,"editBarHeight",195),(0,U.Z)(this,"dimensions",{width:0,height:0,top:0,left:0}),(0,U.Z)(this,"getTextSuggestions",()=>eZ),(0,U.Z)(this,"getStyleSheet",e=>{var t;return t=e,new Promise(e=>{void 0===t&&(t="default"),void 0===eL[t]&&(console.warn("Unknown styleSheet '"+t+"'"),t="default"),e(JSON.parse(JSON.stringify(eL[t])))})}),(0,U.Z)(this,"hydrate",e=>{e&&(this.defaultViewMode=e.defaultViewMode)}),(0,h.makeObservable)(this,{window:h.observable,mouse:h.observable,setWindowSize:h.action,setMousePosition:h.action,setScrollPosition:h.action,setDimensions:h.action,addComponent:h.action,removeComponentByKey:h.action,isSmallScreen:h.observable,_viewMode:h.observable,viewMode:h.computed,showViewModePicker:h.computed,ratio:h.observable,interactive:h.observable,seperatorSize:h.observable,seperator:h.observable,styleSheet:h.observable,muted:h.observable,menuBarEnabled:h.observable,menuBarVisible:h.observable,editMode:h.observable,isProcessingEditMode:h.observable,components:h.observable.shallow,editBarHeight:h.observable,dimensions:h.observable}),this.store=e,this.hydrate(t)}},eI=i(70137),eB=i(31750),eE=i(42261),eO=i(37986);function eR(e){return"content"===e.data.meta.type&&!e.data.meta.floating&&!!e.data.meta.editable}let eV=(0,H.observer)((o=class extends(s=l.PureComponent){componentDidMount(){this.props.page.getData()}componentDidUpdate(){this.props.page.getData()}get blueprint(){return this.ref.current?this.ref.current.blueprint:null}get getLayerByOffset(){return this.ref.current?this.ref.current.getLayerByOffset:null}get highlightLayer(){return this.ref.current?this.ref.current.highlightLayer:null}getOffsetPosition(e,t){let i;let s=e.artboard.el,o=s.createSVGPoint();o.x=t.x,o.y=t.y;let a=o.matrixTransform(s.getScreenCTM().inverse()),n=this.pixelsToSvg(80),r=this.props.page.crop;return a.x<n?i="left":a.x>r.width-n?i="right":a.y<n+r.y?i="top":a.y>r.height-n&&(i="bottom"),i}pixelsToSvg(e){let t=this.blueprint.artboard.el,i=t.createSVGPoint(),s=t.getScreenCTM();i.x=0;let o=i.matrixTransform(s);i.x=80;let a=i.matrixTransform(s),n=80/(a.x-o.x);return e*n}showDropLayer(e){let t,i=!1;if(e){let s=this.pixelsToSvg(80);switch(i="rgba(0,0,0, 0.5)",t={x:this.props.page.crop.x,y:this.props.page.crop.y,width:0,height:0},e){case"left":t.width=s,t.height=this.props.page.crop.height;break;case"top":t.width=this.props.page.crop.width,t.height=s;break;case"right":t.x=this.props.page.crop.width-s+this.props.page.crop.x,t.width=s,t.height=this.props.page.crop.height;break;case"bottom":t.y=this.props.page.crop.height-s+this.props.page.crop.y,t.width=this.props.page.crop.width,t.height=s}}this.ref.current.highlightArea(i,t)}addDnD(e){let t=eO.Z.addTarget("asset",e,{data:{page:this.props.page,spread:this.props.spread},isOver:(e,t)=>{let i={},s=this.blueprint,o=void 0!==t&&t.sourceData.page?t.sourceData.page:void 0,a=void 0!==t&&t.sourceData.spread?t.sourceData.spread:void 0,n=this.props.page,r=this.props.spread,l=void 0!==t&&t.sourceData.layer&&t.sourceData.layer.meta.draggable,d=void 0!==t&&t.sourceData.resize&&t.sourceData.layer.meta.resizable,c=o!==n,h=e&&t.canDrop(),u=void 0!==t&&void 0!==t.sourceData.asset?t.sourceData.asset:void 0,m=void 0===o||a!==r,p=t&&t.sourceData&&t.sourceData.source&&"asset"===t.sourceData.source;if(void 0!==t&&(i.action=t.action),h){if(void 0!==o&&(i.action=m?"copy":void 0),m&&(i.action="copy"),p&&(i.action="move"),u&&"text"===u.type&&(c||m)&&(i.action="copy"),d)i.action="resize";else if(l)i.action="move",c&&this.highlightLayer(s.artboard);else switch(i.action){case"copy":this.highlightLayer(s.artboard);break;case"move":case void 0:let e=this.getLayerByOffset(t.offset);if(e&&u&&!eR(e,u.type)&&(e=void 0),void 0===e)this.highlightLayer(s.artboard),i.action="copy";else{let i=t.sourceData.layer!==e;(i||p)&&void 0!==e?this.highlightLayer(e):this.highlightLayer(!1)}}}else this.highlightLayer(!1),this.showDropLayer(!1);return i},canDrop:e=>{let t=e.sourceData.layer&&e.sourceData.layer.meta.draggable;if(t)return"book-cover"!==this.props.spread.viewMode;let i=this.getLayerByOffset(e.offset),s=this.props.spread,o=this.props.page,a=e.sourceData.layer,n=e.sourceData.page,r=e.sourceData.isSpreadDrag,l=void 0!==e.sourceData.asset?e.sourceData.asset:void 0,d=n!==o;if(r||void 0!==i&&a===i&&(!l||"text"!==l.type)||"book-cover"===s.viewMode&&"text"===l.type)return!1;if("copy"===e.action)return!0;if(l){if(d)return!0;if("text"===l.type&&!d)return!1}if(i&&l){let t=e.sourceData;if(t.layer){let e=t.layer,s=i.data.style&&i.data.style.content&&void 0!==i.data.style.content.asset?i.data.style.content.asset:null;if(s&&!eR(e,s.type))return!1}if(eR(i,t.asset.type))return!0}return!i},drop:e=>{let t=e.sourceData.layer&&e.sourceData.layer.meta.draggable&&!e.sourceData.resize,i=e.sourceData.page===this.props.page,s={dropped:!1},o="layer";switch("copy"===e.action?o="addToPage":"resize"===e.action&&(o="resize"),t&&(o=i?"move":"addToPage"),o){case"addToPage":case"resize":case"move":s={dropped:!0,type:o,page:this.props.page,spread:this.props.spread,blueprint:this.blueprint};break;case"layer":let a=this.getLayerByOffset(e.offset);a&&(s={dropped:!0,type:o,layer:a,page:this.props.page,spread:this.props.spread})}if(this.setState({isDragging:!1}),void 0!==s)return s}}),i=eO.Z.addSource("asset",e,{canDrag:e=>{if(!this.context.ui.editMode)return!1;let t=18===e.keyDown?void 0:this.getLayerByOffset(e.offset,this.blueprint);return!!t&&!!t.meta.editable||!t&&"cover"!==this.props.page.design.type},beginDrag:e=>{let t=null,i=18===e.keyDown?void 0:this.getLayerByOffset(e.offset),s=18===e.keyDown||!i,o=document.elementFromPoint(e.offset.x,e.offset.y);i&&i.meta.editable&&(t=i.data.style&&i.data.style.content&&void 0!==i.data.style.content.asset?i.data.style.content.asset:null);let a=i&&void 0!==i.meta&&!i.meta.draggable||s,n={asset:s?void 0:t,source:"blueprint",page:this.props.page,spread:this.props.spread,layer:s?void 0:i,isSpreadDrag:s,showDragLayer:a,autoScroll:{top:65,bottom:195}};if(i&&i.meta.draggable){let t=i.artboard.el,s=t.createSVGPoint();s.x=e.offset.x,s.y=e.offset.y;let o=s.matrixTransform(t.getScreenCTM().inverse()),a={x:o.x-i.x,y:o.y-i.y};n.dragCorrection=a}let r=o.hasAttribute("resize-hint");r&&(n.resize=o.getAttribute("resize-hint"),n.frame=i.data.frame);let l=o.hasAttribute("move-hint");if(l){var d,c;let e=i.artboard.el,t=e.createSVGPoint();t.x=0,t.y=0;let s=t.matrixTransform(e.getScreenCTM());t.x=i.data.frame.width,t.y=0;let a=t.matrixTransform(e.getScreenCTM()),r={width:a.x-s.x};r.height=i.data.frame.height/(i.data.frame.width/r.width),n.move={hint:o.getAttribute("move-hint"),contentPosition:(null===(d=i.data.style)||void 0===d?void 0:null===(c=d.content)||void 0===c?void 0:c.position)||[50,50],pixelFrame:r},n.showDragLayer=!1}return n},dragMove:e=>{var t,i,s;let o={},a=e.sourceData.layer,n=e.sourceData.page,r=e.sourceData.isSpreadDrag;if(a&&n&&!r){if(e.sourceData.resize){let t={...e.sourceData.frame},i=t.x+t.width,o=t.y+t.height,r=a.artboard.el,l=r.createSVGPoint();l.x=e.beginOffset.x;let d=l.matrixTransform(r.getScreenCTM().inverse()).x;l.x=e.offset.x;let c=l.matrixTransform(r.getScreenCTM().inverse()).x;l.y=e.beginOffset.y;let u=l.matrixTransform(r.getScreenCTM().inverse()).y;l.y=e.offset.y;let m=l.matrixTransform(r.getScreenCTM().inverse()).y;l.x=e.beginOffset.x+30;let p=l.matrixTransform(r.getScreenCTM().inverse()).x,b=p-d,x={x:c-d,y:m-u},g=(null==a?void 0:null===(s=a.style)||void 0===s?void 0:s.rotation)||0;switch(e.sourceData.resize){case"centerright":switch(g){case 0:default:t.width+=x.x,t.width<b&&(t.width=b);break;case 90:if(t.x+=x.x/2,t.y-=x.x/2,t.height+=x.x,t.height<b){let e=b-t.height;t.y-=e/2,t.x+=e/2,t.height=b}}break;case"centerleft":switch(g){case 0:default:t.x+=x.x,t.width-=x.x,t.width<b&&(t.x=i-b,t.width=b);break;case 90:if(t.y+=x.x/2,t.x+=x.x/2,t.height-=x.x,t.height<b){let e=b-t.height;t.y-=e/2,t.x-=e/2,t.height=b}}break;case"topcenter":switch(g){case 0:default:t.y+=x.y,t.height-=x.y,t.height<b&&(t.y=o-b,t.height=b);break;case 90:if(t.y+=x.y/2,t.x+=x.y/2,t.width-=x.y,t.width<b){let e=b-t.width;t.y-=e/2,t.x-=e/2,t.width=b}}break;case"bottomcenter":switch(g){case 0:default:t.height+=x.y,t.height<b&&(t.height=b);break;case 90:if(t.y+=x.y/2,t.x-=x.y/2,t.width+=x.y,t.width<b){let e=b-t.width;t.width=b,t.y+=e/2,t.x-=e/2}}break;case"topleft":switch(g){case 0:default:t.x+=x.x,t.width-=x.x,t.y+=x.y,t.height-=x.y,t.height<b&&(t.y=o-b,t.height=b),t.width<b&&(t.x=i-b,t.width=b);break;case 90:if(t.x+=x.x/2+x.y/2,t.height-=x.x,t.y+=x.y/2+x.x/2,t.width-=x.y,t.width<b){let e=b-t.width;t.width=b,t.y-=e/2,t.x-=e/2}if(t.height<b){let e=b-t.height;t.height=b,t.y-=e/2,t.x-=e/2}}break;case"bottomleft":switch(g){case 0:default:t.x+=x.x,t.width-=x.x,t.height+=x.y,t.height<b&&(t.height=b),t.width<b&&(t.x=i-b,t.width=b);break;case 90:if(t.y+=x.y/2+x.x/2,t.x-=x.y/2-x.x/2,t.width+=x.y,t.height-=x.x,t.width<b){let e=b-t.width;t.width=b,t.y+=e/2,t.x-=e/2}if(t.height<b){let e=b-t.height;t.height=b,t.y-=e/2,t.x-=e/2}}break;case"topright":switch(g){case 0:default:t.width+=x.x,t.width<b&&(t.width=b),t.y+=x.y,t.height-=x.y,t.height<b&&(t.y=o-b,t.height=b);break;case 90:if(t.y+=x.y/2-x.x/2,t.x+=x.y/2+x.x/2,t.width-=x.y,t.height+=x.x,t.width<b){let e=b-t.width;t.width=b,t.y-=e/2,t.x-=e/2}if(t.height<b){let e=b-t.height;t.height=b,t.y-=e/2,t.x+=e/2}}break;case"bottomright":switch(g){case 0:default:t.width+=x.x,t.width<b&&(t.width=b),t.height+=x.y,t.height<b&&(t.height=b);break;case 90:if(t.y+=x.y/2-x.x/2,t.x-=x.y/2-x.x/2,t.width+=x.y,t.height+=x.x,t.width<b){let e=b-t.width;t.width=b,t.y+=e/2,t.x-=e/2}if(t.height<b){let e=b-t.height;t.height=b,t.y-=e/2,t.x+=e/2}}}let f={...t};if("ratio"===a.meta.resizable){let i=a.data.frame.height/a.data.frame.width;f.height=t.width*i,e.sourceData.resize.includes("left")?f.x-=f.width-t.width:e.sourceData.resize.includes("right")&&(f.x+=f.width-t.width),e.sourceData.resize.includes("top")&&(f.y-=f.height-t.height)}(0,h.transaction)(()=>{n.setLayerProperty({layer:a.meta.name,path:["frame"],value:f,temp:!0}),void 0!==a.data.path&&n.setLayerProperty({layer:a.meta.name,path:["path"],value:"M0,0h"+f.width+"v"+f.height+"h-"+f.width+"z",temp:!0})});return}if((null===(t=e.sourceData)||void 0===t?void 0:null===(i=t.move)||void 0===i?void 0:i.hint)==="content"){let t={x:e.beginOffset.x-e.offset.x,y:e.beginOffset.y-e.offset.y},i=e.sourceData.asset.sizes[e.sourceData.asset.sizes.length-1],s=e.sourceData.move.pixelFrame,o=Math.min(i.width/s.width,i.height/s.height),r={width:i.width/o,height:i.height/o},l={width:Math.round(r.width-s.width),height:Math.round(r.height-s.height)},d={x:l.width/100*e.sourceData.move.contentPosition[0],y:l.height/100*e.sourceData.move.contentPosition[1]},c={x:Math.max(0,Math.min(l.width,d.x+t.x)),y:Math.max(0,Math.min(l.height,d.y+t.y))},h=[l.width>0?Math.round(c.x/l.width*1e4)/100:50,l.height>0?Math.round(c.y/l.height*1e4)/100:50];n.setLayerProperty({layer:a.meta.name,path:["style","content","position"],value:h,temp:!0});return}if(void 0!==a.meta&&a.meta.draggable){let t=a.artboard.el,i=t.createSVGPoint();i.x=e.offset.x,i.y=e.offset.y;let s=i.matrixTransform(t.getScreenCTM().inverse()),r=s.x-e.sourceData.dragCorrection.x,l=s.y-e.sourceData.dragCorrection.y,d=n.crop.height-a.height+(a.height-50),c=n.crop.width-a.width+(a.width-50),u=0-(a.width-50),m=0-(a.height-50),p={x:Math.min(Math.max(u,r),c),y:Math.min(Math.max(m,l),d),width:a.width,height:a.height},b=e.overData&&void 0!==e.overData.page&&e.overData.page!==n;return o.showDragLayer=b,(0,h.transaction)(()=>{n.setLayerProperty({layer:a.meta.name,path:["frame"],value:p,temp:!0}),n.setLayerProperty({layer:a.meta.name,path:["style","display"],value:!1!==b?"none":null,temp:!0})}),o}}},endDrag:e=>{var t,i,s;let o=e.sourceData.layer,a=e.sourceData.page,n=e.sourceData.spread,r=e.sourceData.isSpreadDrag;if(r){if(null===(s=e.targetData)||void 0===s||!s.afterSpread)return;n.moveTo({after:e.targetData.afterSpread})}if(!n||!a||!o)return;let l=e.sourceData.asset?e.sourceData.asset:null,d=e.targetData?e.targetData.page:void 0,c=e.targetData?e.targetData.spread:void 0,u=e.targetData?e.targetData.layer:void 0,m=void 0!==o.meta&&o.meta.draggable,p=e.targetData&&e.targetData.dropped,b=void 0!==e.sourceData.resize,x=(null===(t=e.sourceData)||void 0===t?void 0:null===(i=t.move)||void 0===i?void 0:i.hint)==="content",g=e.targetData?e.targetData.type:void 0;(0,h.transaction)(()=>{if(e.didDrop&&p||b||x)switch(b&&(g="resize"),x&&(g="contentPosition"),g){case"resize":a.setLayerProperty({layer:o.meta.name,path:["frame"],value:{...o.data.frame}}),a.setLayerProperty({layer:o.meta.name,path:["path"],value:"M0,0h"+o.data.frame.width+"v"+o.data.frame.height+"h-"+o.data.frame.width+"z"});break;case"contentPosition":a.setLayerProperty({layer:o.meta.name,path:["style","content","position"],value:[...o.data.style.content.position]});break;case"move":a.setLayerProperty({layer:o.meta.name,path:["frame"],value:{...o.data.frame}});break;case"layer":let t=JSON.parse(JSON.stringify(u.data.style.content)),i=JSON.parse(JSON.stringify(o.data.style.content));d.setLayerProperty({layer:u.meta.name,path:["style","content"],value:i}),a.setLayerProperty({layer:o.meta.name,path:["style","content"],value:t}),this.context.edit.setActive({layer:void 0});break;case"spread-spacer":this.context.content.addSpread({insertAfter:e.targetData.afterSpread,add:[{asset:(0,h.toJS)(l),layer:o.data,targetPage:0}]}),a.autoPushToServer=!1,a.setLayerProperty({layer:o.meta.name,path:["style","content"],value:null}),a.autoPushToServer=!0,n.regenerate({mode:"rel",changes:{pages:[a.index]}}),this.context.edit.setActive({layer:void 0});break;case"addToPage":if(m){let t=(0,eT.Z)(),i=JSON.parse(JSON.stringify(o.data));delete i.style.display,delete i.style.editHints,delete i.style.resizeHints,delete i.style.highlight,i.id=(0,eT.Z)(),i.meta.name=t;let s=e.targetData.blueprint.artboard.el,n=s.createSVGPoint();n.x=e.offset.x,n.y=e.offset.y;let r=n.matrixTransform(s.getScreenCTM().inverse()),l={x:o.width/2,y:o.height/2},h=r.x-l.x,u=r.y-l.y,m=d.crop.height-o.height+o.height/2,p=d.crop.width-o.width+o.width/2,b=0-o.width/2,x=0-o.height/2,g={x:Math.min(Math.max(b,h),p),y:Math.min(Math.max(x,u),m),width:o.width,height:o.height};i.frame=g,a.removeLayer(o.meta.name),d.addExtensions("Artboard",[i]),this.context.content.selection=[c.contentItem],this.context.edit.setActive({page:d,layer:t})}else{a.removeLayer(o.meta.name,!1);let e=c===n,t=e?[a.index,d.index]:[d.index];c.regenerate({mode:"rel",add:[{asset:(0,h.toJS)(l),layer:o.data,targetPage:d.index}],changes:{pages:t}}),e||(n.regenerate({mode:"rel",changes:{pages:[a.index]}}),this.context.content.selection=[c.contentItem]),this.context.edit.setActive({page:d,layer:void 0})}}o&&m&&(a.setLayerProperty({layer:o.meta.name,path:["style","display"],value:null,temp:!0}),a.setLayerProperty({layer:o.meta.name,path:["frame"],value:null,temp:!0}))})}});return function(){i.destroy(),t.destroy()}}render(){let e=this.props.page,t=this.props.data,i=this.props.editHints,s=t.x,o={width:e.width,height:e.height,left:s+(e.marginLeft?e.marginLeft:0),position:"absolute"};if(void 0!==e.padding)for(let t in e.padding)o["padding"+(t.charAt(0).toUpperCase()+t.slice(1))]=e.padding[t];void 0!==e.background&&(o.backgroundColor="rgba("+e.background.join(",")+")");let a=void 0!==e.blueprint.data&&void 0!==e.extensions&&void 0!==e.layerData&&void 0!==e.tempLayerData;if(!a)return null;let n={},l=e.getLayersByMetaKey("editable",!0).get();for(let t of l)if(n[t.meta.name]={style:{editHints:i,resizeHints:!1}},i&&this.context.edit&&e===this.context.edit.activePage&&t.meta.name==this.context.edit.activeLayer){var d,c;let e=null===(d=t.style)||void 0===d?void 0:null===(c=d.content)||void 0===c?void 0:c.asset,i=e&&"photo"===e.type?"rgba(var(--accentColor), 1)":void 0;n[t.meta.name]={style:{editHints:"rgba(var(--accentColor), 1)",contentMoveHints:i,resizeHints:!!t.meta.resizable&&{type:t.meta.resizable,color:"rgba(var(--accentColor), 1)"}}}}let u={};for(let t of e.zoomTextLayers)u[t]={style:{textZoom:2}};let m=(0,h.toJS)({...e.blueprint.data,viewMode:this.props.spread.viewMode}),p=(0,eE.Z)(!0,(0,h.toJS)(e.layerData),(0,h.toJS)(e.tempLayerData),n,u),b=(0,h.toJS)(e.extensions),x=e.getLayerByName("right").get(),g=x&&e.moveRight?{x:x.frame.x+e.moveRight.x,y:x.frame.y+e.moveRight.y}:void 0;return(0,r.jsx)(eB.Z,{ref:this.ref,eventListener:this.props.eventListener,config:{fitPhotosToViewport:"cover"===this.props.spread.viewMode,useFontFallback:!0},style:o,data:m,extensions:b,layerData:p,viewBox:e.crop,rightFrame:g,onMount:e=>{let t=this.addDnD(e);return t}})}constructor(...e){super(...e),(0,U.Z)(this,"ref",l.createRef())}},(0,U.Z)(o,"contextType",Z.Z),o)),eJ=new String('.panorama.jsx-43df272cae011e53{background-color:black;overflow:hidden;position:relative;scrollbar-width:none;-ms-overflow-style:none;cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in}.panorama.jsx-43df272cae011e53 .jsx-43df272cae011e53::-webkit-scrollbar{width:0;height:0}.panorama.jsx-43df272cae011e53 img{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-o-user-select:none;-ms-user-select:none;user-select:none;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.panorama.jsx-43df272cae011e53 .panorama-scroller{overflow-x:scroll;position:absolute;top:0px;left:0px;right:0px;bottom:0px;z-index:10}.panorama.jsx-43df272cae011e53 .panorama-sidebar{position:absolute;z-index:11;top:0px;bottom:0px;width:200px;max-width:25%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer}.panorama.jsx-43df272cae011e53 .panorama-sidebar-left{left:0px;top:0px;cursor:url("data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAYAAABzJ5OsAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAL6ADAAQAAAABAAAALwAAAADLnOTNAAAFp0lEQVRoBdWaXWgcVRTHZ7fafKf5EG0Wo6ZpUpqv5gMUQRAU1JLSlBIDhWJigvsg+lSoNorGIqgP8UWFkJqYQHxIiGCDya5Cn3wIFTaJ+aAkIcbSstFCPpZku9A2u/7/0zvL7GbW7s7MTrcHTu7MnXvP/Z07d3buORObZIKEQqESmDkJbYAegT4NzYFmQm9Dt6E3oYtQD3TMZrOtonw4AuBj0IvQP6F6hP3Y/5heD2yJdsRgR9HnC2iT0hd1vp2dnSvr6+t/bG1t/UOZmZm5NTIystHS0lJQW1v75EFIXl7ewcLCwuezs7NfxcwfUPqjvAy9gLprqjrzDgHogPZC70FDwWBwG7D9k5OTLaWlpcUYyRGvVlZWPsN+7E87tAehXdqnHfMEBo9Dt6CUOxy0s7OzCiPEDRyrLe3QHu3K1u+Pc9wUehg8B92lYSwNd19f34uxQIzU0y7tcxwIxzv3IAdirnl03o/OvdBWaGhtbe0rh8PxzYMMGr3u9XrfLyoq+gB2yDYIdeJZuKNl165VKepkcDjhn5uba7cCnONyHI7HcXHKiSOHpmjCi1vWSgPj4+Ona2pqftPsnaRKjud2u08rDgiePaPtWTZoyIflF6iNM2A1uJpwdnb2terq6n7UhaAnsHxc6usR8AB34CJ/a3Oxxr+0aqmogaKPxTPwIep90Ao44FXaRC+bLlzI9fv9v6YCOCHJQR4c8qXWBQ1LGB6zzjdnO/Tu8PDwZ+EWJhzgpfSY0+nM1WtK8NxFfz7I5JQlvGxQ+TNqmjY2Nn7AK/xjcd1w0djYmD46OjqYlpbWYLfbD+s1iBfZ5wUFBW+j/2UsnVO0I888wLk5akK5093d/TUvmCEKeHp6+kubm5s/GrFJLvLBBjnJe19wwt1diK9p1PChNawAPxQIBH4Xdi+ZYVNsI2jyIsmVNd/Ek6WlJTdLo6KecSzD77EMPzVqk/1VfDKvDV6UoP4vlL6ysrLqlZWVXSMDJQucTNi97lteXp7Dmj+A00OceUZAEvfjqQxORvKRk8eQk4Rn6CZhPV1lqVeSOeNqJhVnA+EZc0qIgP5VN0rk2CrwKM4jhGcUJDF0Y5moRIH3mfVwxuJQcRYTnlG+NDU1lfDMa4B/EmtQs+pVnDn8tbkHw/vq6+ufm56e5is4bsGm6V0EDh/h9/xKZmbmW3F3NNCwrq7ucTjwN0zscuYDtNXc3JzPMhFxuVzjCKC9GRkZLy8sLJxIpK/etsxGiL63Cc+EkISZf0pUxl10dHRcHxgYaIYDtyoqKr6zwgGmUQTgNuFv8IR5FVGZUGG1AyrOm4RnCk5CQijhmVe8tNIBJq7EuIuEZ+5Qwk/cC6JSV2GVAypOD+HHSMsUHPcOushFp2Q7QD5wviKGG7Njk7OKk1ludoaGhphQMiTJdIB8YlNG3lXOPIWJTqm8vPwNlkYlWQ6o+GReBf4nAufn57+J3KHyO2rIB7MdIBf5BJTMm/QYFjnIZ9va2kYRvz6BW83YQZdgN6kdwwprF1DuIsg9ywF1jaDRiXegp6fnlMfjYfCsS8hDLnRmoEROWcIzzzPsc3pRvMM8CZ7qdrlFCvxBANKflZX1OlAu4e45FSRlzSvnXTjwsSEzVUrlwyzJIcCZMetSs0TAwyum0s5Ag0wzM1eobmz1MccX6e4guQRfGCMCnrVo4EJxnodVVVXfTkxM8AuI5cJxOT4G5tI+L7giOCLWvPoK1v8AzltR+ufn59+zMlvMGSc4gLPAMIiyDeUe+T/4/WjNB7gVmpJfRvZ4E12BmU/Zb1LRrJrncIBfA31QyqPzNVDxBtCmfYfF7rDYjO+wMde8Ah1dwomjqIv1Bfwq8z9MTzDKR2p7k7ExQ0xGQAx4uB+3/Au4hhOP3v8eRDvBc9yNEhTq //pgIisHmgENQBnkM1ZehHqgpvzXx38IbzMa7+JUWwAAAABJRU5ErkJggg==")22 22,no-drop}.panorama.jsx-43df272cae011e53 .panorama-sidebar-right{right:0px;cursor:url("data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAYAAABzJ5OsAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAL6ADAAQAAAABAAAALwAAAADLnOTNAAAFsUlEQVRoBdWaXUwcVRTHZ7exQRfKV0LLRlSk0FS+aazxAR80qE1MMQ1CJEaURB5IfWpShfiwVhP1gb7YJxS0CT5A1qQlQtc1PvFA2oQPgcQAIiZuQEtANrCttt1d ///pnc3dZZd2du9s6UkOd+bOvef87pm7c+eewaYpkHA4XAwzJ6HHoEegj0OzoI9Bb0C3oD7oPHQCOmyz2ZZRPhgBcDX0HPQXaDLCfuxfnewIbGY7wtlR9PkM2mj0RZ1/e3v75/X19Wubm5t/Uaanp68PDQ1tNDc359XU1BQcguTk5BzKz88/npmZ+RIin230R3kZ2oW6X6U6dYcAdEJ7oXeg4VAotAXY/vHx8eaSkpIieHLer5aXlz/BfuxPO7QHoV3apx11AoMnoJtQyi067e7uroCH+wZO1JZ2aI92det3/ZxQQg+DZ6BBGsbU8PT19T2fCCSVetqlffqB0N+Zew0g4ZxH5/3o3Attg4ZXV1e/cDqdX97LYKrXV1ZW3i8sLPwAdsh2EdqB38KteHbt8SpFnQ6OQQRmZ2fb0wFOv/RDf/SLUwaOHHElLry4ZW00MDIycqqqqsobt7dFlfTn8XhOGQMQPDu87Zg2aMgfyw9QGyOQbnCZcGZm5uXKysp+1IWhr2H6XJGvR8ED3ImLfNYewBz/PF1TRQaKPRa/gQ9R74c+gwGsGG1ip40LFw4EAoEf9wI4IclBHhxyUXNBIxKBR9S5crZDbw8ODn4caWHiAIvVvs7OTnnlNNE7cVPBcxst+EMmZ7Sg8hI0zAUDVzh9TKvP5/sEJv6bmpriU8J0/936iIWMiJfQThc98qioxlkjyu2enp7z4prpYmxszIvl3o93mV4MoMG0gV06kIt8aEJO8t4VnPDtLqWow5IeadziF4LB4HWYU34HpOifI7kx5xt5srCw4GGZirS0tPzmdrubrLgDEp/Oa0OEigH7O0p/aWlp5dLSUjAVeKMv7sDhpqYmt91uz8brcUdtbe1PxrVkSz4QFhcXZ/G4zIaNpxl57oA0vo+rAqc9K+4A+chJ+5CThOfWTcN8uspSpVgxAInzGOG559SwA/pbJbhhS/UAJM4jhOcuSOPWzXCoulQ5AImziPDc5WuTk5OWRN4IhKoBSJxZfNrcgYN9dXV1T2Fh4RJsqXi93pqGhoYROPkXT40Ss87w1HoEA/gD/YKM/E0awGMtl6WV0tra6qivr3fRx9ra2tfJ+GI2QvS7QXgmhDRE/qCotKQgOPap32VkZDwL8AsFBQVMn5gWplFEpy3C/8kT5lVEpfJCFXgMp4/wTMFpSAhZEnmV4ILTCPI84Zk71JDJeo6lSlENTjaJc4Lww6xkCo7vDjxWIVaAkw+cLwq+YTseV8s4meHLzsDAABNKKYsV4IQin3gpI+8yI09holMrKyt7lWUqYhU4mSQ+ndeA/54Xc3Nz30Du0HiOssqUWAlOLvIJIJ03kvrASsu9YePGxsY3+FF8ZIpaNEaa4jRSdV2pPMcT+cXb5Kd5eXnv4vplTJnX2c6IPI+7oEE0eAuLyZOsMCuYk268Yryd7AKUyB95yIXr3CiRU5dI5HmG6PeieI95Evyq2/UWe+APNiD9DofjFaB8hah3GEhy5FnngvrZkJkqVjxoIYcAZ8bMJfNEwWNUTKW9CQ0xzcxcodw43cf0L9LdIXIJvghGFDxr0eAKirM8rKiouDA6OsovIGkX+qV/OObUPiu4ojii5rx8BfP/W5y3oQzMzc2dTme2mBEnOIAdYLiI8h2UO2Q3+P1ozR8wU3d78svIjtHEViDye/abVCxr3HMMgF8D/VDKw/M10BgNoJV9h8XbYZGK77AJ57wBHVtiEEdRl+gL+FXmVZie4C4fOct/uDfmFlN8AT/I9/G0fwGPM4iH738PYgfBc9yNYhTyf30wkZUFfRR6E8pNPvfK89AJqJL/+vgfXSU95n/kWwoAAAAASUVORK5CYII=")22 22,no-drop}');eJ.__hash="43df272cae011e53";class eH extends l.Component{resize(){let e=this.props.imageSizes.slice()[0];for(let t of this.props.imageSizes)if(t.width>=this.props.width&&t.height>=this.props.height){e=t;break}let t=this.props.height/e.height*e.width;this.setState({translateX:0,imageWidth:t,imageSize:e})}componentDidUpdate(e){(e.width!==this.props.width||e.height!==this.props.height)&&this.resize()}componentDidMount(){this.resize(),this.startAnimating(0),this.ref.current.addEventListener("mousemove",this.onMouseMove,{passive:!0}),this.ref.current.addEventListener("mouseleave",this.onMouseLeave,{passive:!0}),this.ref.current.addEventListener("mousedown",this.onMouseDown,{passive:!0}),this.ref.current.addEventListener("click",this.onClick,{passive:!0}),this.ref.current.addEventListener("contextmenu",this.onContextMenu)}componentWillUnmount(){this.stopAnimating(),this.ref.current&&(this.ref.current.removeEventListener("mousemove",this.onMouseMove,{passive:!0}),this.ref.current.removeEventListener("mouseleave",this.onMouseLeave,{passive:!0}),this.ref.current.removeEventListener("mousedown",this.onMouseDown,{passive:!0}),this.ref.current.removeEventListener("click",this.onClick,{passive:!0}),this.ref.current.removeEventListener("contextmenu",this.onContextMenu))}onContextMenu(e){e.preventDefault(),e.stopPropagation(),this.props.onContextMenu({event:e})}onMouseMove(e){let t=e.target.classList.contains("panorama-sidebar");if(t){let t=e.target.classList.contains("panorama-sidebar-left")?"right":"left";this.setState({direction:t,speed:2,manual:!0}),this.startAnimating(0)}else this.setState({speed:1,manual:!1}),this.stopAnimating(),this.startAnimating()}onMouseLeave(){this.setState({speed:1,manual:!1})}onMouseDown(e){let t=e.target.classList.contains("panorama-sidebar");if(t){let t=e.target.classList.contains("panorama-sidebar-left")?"right":"left";this.setState({direction:t,speed:12,manual:!0})}}onClick(e){let t=e.target.classList.contains("panorama-sidebar");t?this.setState({speed:2}):this.props.onMouseUp({event:e})}lock(e){this._lock=e}animate(){if(!this.animationAllowed||this.isAnimating||!this.scrollRef.current)return;this.isAnimating=!0;let e=this.props.width-this.state.imageWidth,t=Math.max(e,Math.min(0,"left"===this.state.direction?this.state.translateX-this.state.speed:this.state.translateX+this.state.speed)),i=this.state.direction;!this.state.manual&&(t<=e||t>=0)&&(i="right"===this.state.direction?"left":"right"),this.setState({translateX:t,direction:i});try{this.scrollRef.current.scrollTo(0-t,0)}catch(e){this.scrollRef.current.scrollLeft=0-t}requestAnimationFrame(()=>{this.isAnimating=!1,this.animate()})}stopAnimating(){this.animationAllowed=!1,this.animateTimer&&clearTimeout(this.animateTimer),this.animateTimer=void 0}startAnimating(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;this.animateTimer=setTimeout(()=>{this.animationAllowed=!0,this.animate()},e)}onScroll(){if(!this.scrollRef.current)return;let e=0-this.scrollRef.current.scrollLeft;this.state.translateX!==e&&(this.stopAnimating(),this.startAnimating(),this.setState({translateX:e}))}render(){let e={width:this.props.width,height:this.props.height},t=null;return this.state.imageSize&&(t=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{className:"panorama-image",alt:"panorama",src:this.state.imageSize.url,style:{transform:"translateX("+this.state.translateX+"px)"},height:this.props.height,width:this.state.imageWidth,draggable:!1}),(0,r.jsx)("div",{ref:this.scrollRef,className:"panorama-scroller",style:{height:this.props.height+50,width:this.props.width},onScroll:this.onScroll,children:(0,r.jsx)("div",{style:{width:this.state.imageWidth,height:this.props.height}})}),!this.supportsTouch&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"panorama-sidebar panorama-sidebar-left"}),(0,r.jsx)("div",{className:"panorama-sidebar panorama-sidebar-right"})]})]})),(0,r.jsxs)("div",{ref:this.ref,style:e,className:"jsx-".concat(eJ.__hash)+" panorama",children:[t,(0,r.jsx)(v(),{id:eJ.__hash,children:eJ})]})}constructor(e){super(e),(0,U.Z)(this,"scrollRef",(0,l.createRef)()),(0,U.Z)(this,"ref",(0,l.createRef)()),(0,U.Z)(this,"state",{translateX:0,direction:"left",speed:1,manual:!1}),this.onScroll=(0,ei.P)(16,this.onScroll.bind(this)),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.supportsTouch="ontouchstart"in window||navigator.msMaxTouchPoints}}(0,U.Z)(eH,"defaultProps",{onClick:()=>{},onContextMenu:()=>{}});var eF=i(4498);let eG=(0,H.observer)((n=class extends(a=l.PureComponent){componentDidMount(){this._mounted=!0}componentWillUnmount(){this._mounted=!1}renderPano(e,t){let i=(0,r.jsx)(eH,{imageSizes:e.pano.asset.sizes,width:e.width,height:e.height,onContextMenu:t=>{t.page=e,t.layer=e.pano.layerName,this.props.onContextMenu(t)},onMouseUp:t=>{t.eventType="click",t.page=e,t.layer=e.pano.layerName,this.props.eventListener(t)}},"pano-"+t);return{content:i}}renderBlueprint(e,t,i){let s=(0,r.jsx)(eV,{data:i,page:e,spread:this.props.spread,styleSheet:this.props.styleSheet,editHints:this.props.editHints,textView:this.props.textView,eventListener:t=>{t.page=e,this.props.eventListener(t)}},"blueprint-"+t);return{content:s,width:e.width}}render(){let e={...this.props.style},t=0;return(0,r.jsxs)("div",{style:e,className:"jsx-".concat(eF.AB.__hash)+" page-row",children:[this.props.pages.map((e,i)=>{let s;return void 0!==(s="pano"===e.type?this.renderPano(e,i,{x:t}):this.renderBlueprint(e,i,{x:t})).width&&(t+=s.width),s.content}),(0,r.jsx)(v(),{id:eF.AB.__hash,children:eF.AB})]})}constructor(e){super(e),this._mounted=!1}},(0,U.Z)(n,"defaultProps",{onContextMenu:()=>{},onMouseUp:()=>{},onMouseDown:()=>{},onClick:()=>{},onDblClick:()=>{}}),n));class eW extends l.PureComponent{render(){let e={height:this.props.height,width:"100%",backgroundColor:this.props.backgroundColor,borderTopColor:this.props.arrowColor,borderBottomColor:this.props.arrowColor,zIndex:this.props.index,...this.props.style};return(0,r.jsxs)("div",{style:e,className:"jsx-".concat(eF.Co.__hash)+" "+("page-attachment arrow-"+this.props.arrow+" "+this.props.className||0),children:[this.props.children,(0,r.jsx)(v(),{id:eF.Co.__hash,children:eF.Co})]})}}eW.defaultProps={arrowColor:"white",backgroundColor:"transparent",arrow:"bottom",style:{},className:""};var eU=function(e){let t=(0,l.useRef)(),i=(0,l.useRef)(),[s,o]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{t.current?i.current=eO.Z.addTarget("asset",t.current,{isOver:(e,t)=>{var i;let s=e&&t&&Object.keys(t.sourceData).length&&t.canDrop(),a=null==t?void 0:null===(i=t.sourceData)||void 0===i?void 0:i.isSpreadDrag,n={};return e&&s&&(n.action="copy"),a&&(n.action="move"),o(e&&s&&void 0===t.sourceData.resize),n},canDrop:e=>{var t,i,s;let o=null==e?void 0:null===(t=e.sourceData)||void 0===t?void 0:t.isSpreadDrag;if(o)return!0;let a=e.sourceData.sourceLayer&&e.sourceData.sourceLayer.meta.draggable;if(a)return!1;let n=null===(i=e.sourceData)||void 0===i?void 0:null===(s=i.move)||void 0===s?void 0:s.hint;return!n},drop:()=>({dropped:!0,type:"spread-spacer",afterSpread:e.spread})}):i.current&&i.current.destroy()},[t.current]),0===e.height)?null:(0,r.jsxs)("div",{ref:t,style:{height:e.height,width:"100%"},className:"jsx-1dfd181f35664f34 spread-spacer"+(s?" isOver":""),children:[s&&(0,r.jsx)("div",{className:"jsx-1dfd181f35664f34 label",children:P.default.translate("context.edit.add-page")}),(0,r.jsx)(v(),{id:"1dfd181f35664f34",children:'.spread-spacer.jsx-1dfd181f35664f34{overflow:hidden;width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.spread-spacer.isOver.jsx-1dfd181f35664f34:after{content:"";height:2px;width:inherit;max-width:50%;display:block;background-color:rgba(65,65,65,1);margin-right:60px}.spread-spacer.jsx-1dfd181f35664f34 .label.jsx-1dfd181f35664f34{position:relative;border:1px solid rgba(65,65,65,1);background-color:rgba(65,65,65,1);height:24px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;white-space:nowrap;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border-right:0px;margin-left:60px;padding-left:10px;padding-right:5px;color:white;font-size:10px;text-transform:uppercase}.spread-spacer.jsx-1dfd181f35664f34 .label.jsx-1dfd181f35664f34:before{content:"";display:inline-block;width:0;height:0;border-top:12px solid transparent;border-bottom:12px solid transparent;border-left:12px solid rgba(65,65,65,1);position:absolute;right:-12px;top:-1px}'})]})};function eK(e){let{contentItem:t,prepends:i,appends:s,pageRows:o,style:a}=e,n=(0,l.useContext)(Z.Z),d=e.style.marginBottom,c=0;for(let e of o)c+=e.height;let h={style:{height:e.style.height}};return(0,r.jsx)(u.Qj,{children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{spread:t.key,...h,"page-number":t.label,"view-mode":t.contentType.viewMode,className:"jsx-".concat(eF.X8.__hash)+" "+(h&&null!=h.className&&h.className||"spread"+(t.isSelected?" selected":"")+(n.ui.editMode?" edit-mode":"")||0),children:[i.map((e,t)=>{let s=["prepend"];return 0===t&&s.push("first"),t===i.length-1&&s.push("last"),t!==i.length-1&&t>0&&s.push("middle"),(0,r.jsx)(eW,{height:e.height,arrow:"bottom",index:100-t,style:e.style,className:s.join(" "),children:e.component},"prepend-"+t)}),c>0&&(0,r.jsx)("div",{className:"jsx-".concat(eF.X8.__hash)+" border-top"}),o.map((t,i)=>{let s=e.id+"-row-"+i,o={width:t.width,height:t.height,marginTop:t.marginTop,marginLeft:(a.width-t.width)/2,paddingTop:t.paddingTop};return(0,r.jsx)(eG,{style:o,editHints:n.ui.editMode,spread:e.spread,pages:t.pages,prepends:t.prepends,appends:t.appends,eventListener:e.eventListener},s)}),e.message&&(0,r.jsx)(eQ,{style:{height:a.height},type:e.message.type,msg:e.message.msg,contentItem:t}),"cover"===e.viewMode&&(0,r.jsx)("div",{onClick:t=>{e.eventListener({eventType:"arrow",event:t})},className:"jsx-".concat(eF.X8.__hash)+" cover-arrow",children:(0,r.jsx)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 40 40",preserveAspectRatio:"xMidYMin meet",className:"jsx-".concat(eF.X8.__hash)+" icon",children:(0,r.jsx)("path",{id:"path_2",d:"M26.506,18.507l-6.007,5.992l-6.008-5.992",transform:"translate(0,18) scale(1,-1) translate(0,-18)",className:"jsx-".concat(eF.X8.__hash)})})}),c>0&&(0,r.jsx)("div",{className:"jsx-".concat(eF.X8.__hash)+" border-bottom"}),s.map((e,t)=>{let s=["append"];return 0===t&&s.push("first"),t===i.length-1&&s.push("last"),(0,r.jsx)(eW,{height:e.height,arrow:"top",style:e.style,children:e.component},"append-"+t)})]}),(0,r.jsx)(eU,{height:d,spread:e.id}),(0,r.jsx)(v(),{id:eF.X8.__hash,children:eF.X8})]})})}function eQ(e){let t=(0,l.useContext)(Z.Z),{contentItem:i}=e,[s,o]=b.Z.useOpener(),[a,n]=(0,l.useState)(null);(0,l.useEffect)(()=>{switch(console.log(e),e.type){case"error":console.error(e.msg);break;case"warning":console.warn(e.msg);break;default:console.log(e.msg)}},[]);let d=(0,l.useCallback)(()=>{o(!1)},[]);return(0,r.jsxs)("div",{style:e.style,onContextMenu:function(e){n(e),o(!0)},className:"jsx-".concat(eF.xN.__hash)+" spread-message-wrapper",children:[(0,r.jsxs)("div",{className:"jsx-".concat(eF.xN.__hash)+" spread-message spread-message-"+e.type,children:[(0,r.jsx)("span",{className:"jsx-".concat(eF.xN.__hash)+" spread-message-type",children:e.type})," ",JSON.stringify(e.msg.message)]}),(0,r.jsx)(v(),{id:eF.xN.__hash,children:eF.xN}),(0,r.jsx)(b.Z,{isOpen:s,position:{event:a},onRequestClose:d,children:t.ui.editMode&&void 0!==i&&i.isDeletable&&(0,r.jsx)(b.Z.Item,{title:P.default.translate("context.delete-page",{page:i.label?" "+i.label:""}),onClick:()=>{w.Z.Confirm({title:P.default.translate("context.delete-page",{page:i.label?" "+i.label:""}),description:P.default.translate("context.delete-page-confirmation-msg",{page:i.label?" "+i.label:""}),okButtonText:P.default.translate("base.delete")}).then(()=>{i.delete()}).catch(()=>{})}})})]})}var eX=i(38026),eq=i(14814),eY=class{render(e,t){return(0,r.jsx)("div",{style:t},"content-type-"+e)}getSize(){return Promise.reject("getSize not implemented (content-type/"+this.contentItem.type+")")}dispose(){for(let e of this.disposers)e()}constructor(e){(0,U.Z)(this,"disposers",[]),new eq.Z(this),this.contentItem=e}},e$=i(9980),e0=i.n(e$),e1=class extends eY{get autoPushToServer(){return this._autoPushToServer>0}set autoPushToServer(e){e?this._autoPushToServer++:this._autoPushToServer--,this._autoPushToServer>1&&(this._autoPushToServer=1)}setPage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,h.transaction)(()=>{(0,h.runInAction)(()=>{this.autoPushToServer=!1;let i=e.data?e.data:()=>new Promise(e=>{this.fetch().then(i=>{let s=i.pages[t].data;e(s)}).catch(()=>{})}),s=new eI.Z({index:t,design:e.design,data:i}),o=[];for(let e=0;e<this.pages.length;e++){let i=this.pages[e];e===t?o.push(s):o.push(i)}for(let e of this.pages)e.dispose();this.pages.replace(o),this._fetchPromise=void 0,this._getPageRowsCacheKey=null,this.contentItem.calculateLayout(!0),this.autoPushToServer=!0,this.store.edit&&this.store.edit.spreadPagesChanged(this)})})}setPages(e){(0,h.transaction)(()=>{this.autoPushToServer=!1;let t=[];for(let i of(e.forEach((e,i)=>{let s=e.data?e.data:()=>new Promise(e=>{this.fetch().then(t=>{let s=t.pages[i].data;e(s)}).catch(()=>{})}),o=new eI.Z({index:i,design:e.design,data:s});t.push(o)}),this.pages))i.dispose();this.pages.replace(t),this._fetchPromise=void 0,this._getPageRowsCacheKey=null,this.contentItem.calculateLayout(!0),this.autoPushToServer=!0,this.store.edit&&this.store.edit.spreadPagesChanged(this)})}fetch(){return this._fetchPromise||(this._fetchPromise=new Promise((e,t)=>{let[i]=(0,eX.FetchJSON)(this.data.url);i.then(i=>{let s=i.data,o=!0;if(s.pages.length!==this.pages.length)o=!1;else for(let e=0;e<s.pages.length;e++){let t=s.pages[e],i=this.pages[e];if(i.design.key!==t.design.key){o=!1;break}}o?e(s):(this.setPages(s.pages),t())}).catch(e=>{t(e),this.contentItem.delete()})})),this._fetchPromise}get key(){return this.contentItem.key}get pageData(){let e=[];for(let t of this.pages){let i=(0,h.toJS)(t.data);e.push({data:{blueprintExtensions:i.blueprintExtensions,layerData:i.layerData},design:{key:t.design.key}})}return e}save(){return new Promise(e=>{this.saveCancel&&this.saveCancel();let t=this.store.album.key,i=this.pageData,[s,o]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+t+"/spreads/"+this.key,{method:"PUT",data:{pages:i}});this.saveCancel=o,s.then(()=>{e()}),s.catch(e=>{console.error("spread save failed",e)})})}getSize(e){let t=e.viewMode,i=e.viewPort,s=e.seperatorWidth,o=e.seperatorHeight;if(i.width<=0||i.height<=0)return this.width=0,this.height=0,Promise.resolve({width:this.width,height:this.height});let a=this.getViewMode(t);return new Promise(e=>{this.getCachedPageRows(a,i,s,o).then(()=>this.fixPanos(a)).then(()=>{e({width:this.width,height:this.height})}).catch(t=>{this.message={type:"error",msg:t},e({width:this.width,height:100})})})}getViewMode(e){return this.store.ui.editMode&&"smallscreen"===e&&(e="book"),e}fixPanos(e){return new Promise(t=>{1!==this.pages.length||this.store.ui.editMode||"book"===e?t(!1):this.pages[0].getData().then(e=>{let i,s=[];for(let t in e.layerData){let o=e.layerData[t],a=(0,eM.WJ)(o,["style","content","asset"]);if(s.push(a),i=t,s.length>1)break}if(1===s.length){let e=s[0];if(!(e&&Array.isArray(e.sizes)))return t(!1);{let s=e.sizes.slice(-1)[0],o=s.width/s.height;if(!(o>=2.98))return t(!1);t({asset:e,layerName:i})}}else t(!1)})}).then(e=>{this.pages[0].pano=e,e&&this.pano(this.viewPort.width,this.viewPort.height,e)})}getCachedPageRows(e,t,i,s){let o=[JSON.stringify(t),e,this.store.ui.editMode?"editmode-on":"editmode-off",i,s].join("-");return this._getPageRowsCacheKey!==o&&(this._getPageRowsCacheKey=o,this.getPageRowsPromise=this.setPageRows(e,t,i,s)),this.getPageRowsPromise}setPageRows(e,t,i,s){return this.viewMode=e,this.viewPort=t,this.seperatorWidth=i,this.seperatorHeight=s,this._setPageRowsId++,new Promise((i,s)=>{(0,h.runInAction)(()=>{this.pageRows=[],this.prepends=[],this.appends=[],this.preferBlueprint="default"});try{switch(e){case"cover":this.pageSpacing.vertical=this.pageSpacing.default,this.pageSpacing.horizontal=0,this.cover(t.width,t.height,t.inset),i();break;case"book-cover":case"book-backside":this.pageSpacing.vertical=this.pageSpacing.default,this.pageSpacing.horizontal=0,this.bookCover(t.width,t.height,"book-backside"===e?"backside":"cover"),i();break;default:case"fit":this.pageSpacing.vertical=0,this.pageSpacing.horizontal=0,this.fit(t.width,t.height),this.store.ui.editMode?i():this.cutout(this.width).then(()=>{i()});break;case"fill":this.pageSpacing.vertical=0,this.pageSpacing.horizontal=0;let s=new Promise(e=>{this.store.ui.editMode?e(this.pages):this.getNonEmptyPages(this.pages).then(t=>{e(t)})});s.then(e=>{this.fill(e,t.width),this.store.ui.editMode?i():this.cutout(this.width).then(()=>{i()})});break;case"book":this.pageSpacing.vertical=0,this.pageSpacing.horizontal=this.pageSpacing.default,this.book(t.width,t.height),i();break;case"smallscreen":this.pageSpacing.vertical=0,this.pageSpacing.horizontal=0,this.fill(this.pages,t.width),this.cutout(t.width).then(()=>{i()})}}catch(e){s(e)}})}getBestBlueprintForViewport(e,t){let i,s=t.height/t.width;for(let t=0;t<e.length;t++){let o=e[t],a=o.artBox.height/(o.artBox.width/2),n=i?i.artBox.height/(i.artBox.width/2):void 0,r=Math.abs(s-a),l=i?Math.abs(s-n):void 0;(void 0===n||r<l)&&(i=o)}return i}getBestBlueprints(e,t,i){let s=[];for(let o of e){let e=o.design.blueprints;if(void 0!==o.design.type&&"cover"===o.design.type){let o=this.getBestBlueprintForViewport(e,{width:t,height:i});s.push(o);continue}if(this.preferBlueprint){let t=e.filter(e=>e.key===this.preferBlueprint);if(t.length>0){s.push(t[0]);continue}}for(let t of e)if("smallscreen"!==t.key){s.push(t);continue}}return s}bookCover(e,t,i){let s=this.pages[0].design.blueprints.find(e=>"landscape-2"===e.key),o={width:s.artBox.width/2,height:s.artBox.height,x:"cover"===i?s.artBox.x+s.artBox.width/2:s.artBox.x,y:s.artBox.y},a=s.artBox.width,n=s.artBox.height,r=Math.max(a/e,n/t),l=Math.min(e,2*Math.round(a/r/2)),d=Math.round(l/(a/n));l=Math.min(e,2*Math.round(o.width/r/2)),this.width=l,this.height=d;let c=[],h=0;for(let e of this.pages)e.setBlueprint(s),e.setConfig({crop:o,width:this.width,height:this.height,marginLeft:h>0?this.pageSpacing.horizontal:0,type:"blueprint"}),c.push(e),h++;this.pageRows.push({pages:c,width:this.width,height:this.height,marginTop:0})}cover(e,t,i){var s,o,a,n,r,l,d,c;let u=this.getBestBlueprints(this.pages,e,t),m=(0,h.toJS)(u[0]),p=(s={},o=m.width/2,a=m.height,n=m.artBox.width/2,r=m.artBox.height,l=Math.min(l=t/e,Math.max.apply(null,[r/o,r/n,a/o,a/n])),d=r/l,c=r,d<n&&(c=(d=n)*l),d>o&&(d=o)>m.width&&(d=m.width),s.width=Math.round(d),s.height=Math.round(c),s.x=Math.round(m.width/2),s.y=Math.round((m.height-c)/2),s),b=e/p.width,x=Math.round(p.height*b)+i.top,g={width:m.artBox.width/2,height:m.artBox.height},f={x:(p.width-g.width)/2,y:0};(0,h.runInAction)(()=>{this.width=0,this.height=0,this.pageRows=[]}),(0,h.transaction)(()=>{let t=0;for(let s of this.pages){let o=u[t];s.setBlueprint((0,h.toJS)(o)),s.setConfig({crop:p,moveRight:f,width:e,height:x,type:"blueprint"});let a={pages:[s],width:e,height:x,paddingTop:i.top};a.width=e,a.height=x,(0,h.runInAction)(()=>{this.pageRows.push(a),this.width=a.width,this.height+=a.height}),t++}})}pano(e,t,i){let s=Math.max(1,window.devicePixelRatio/1.5),o=i.asset.sizes.slice(-1)[0],a=o.width/o.height,n=Math.min(o.height/s,t),r=(e+200)/a,l=1/(n/r),d=n;switch(this.store.ui.viewMode){case"book":d=n*l;break;case"fit":d=n*(l+(1-l)/2);break;default:d=n}d=Math.max(r,d);let c=this.pages[0];c.setConfig({width:e,height:d,type:"pano"});let h={pages:[c],width:e,height:d};this.pageRows=[h],this.width=e,this.height=d}fill(e,t){let i=this.getBestBlueprints(e);this.width=0,this.height=0,this.pageRows=[];let s=0;for(let o of e){let e=i[s],a=e.artBox.width,n=Math.round(e.artBox.height/(a/t)),r=s?this.pageSpacing.vertical:0;o.setBlueprint((0,h.toJS)(e)),o.setConfig({crop:e.artBox,width:t,height:n,type:"blueprint"});let l={pages:[o],width:t,height:n,marginTop:r};l.width=t,l.height=n,this.pageRows.push(l),this.width=l.width,this.height+=l.height,this.height+=r,s++}}fit(e,t){let i=this.getBestBlueprints(this.pages);this.width=0,this.height=0,this.pageRows=[];let s=0;for(let o of this.pages){let a=i[s],n=a.artBox.width,r=a.artBox.height,l=r/n,d=Math.max(n/e,r/t),c=Math.round(r/d),u=Math.floor(c/l),m=s?this.pageSpacing.vertical:0;o.setBlueprint((0,h.toJS)(a)),o.setConfig({crop:a.artBox,width:u,height:c,type:"blueprint"}),this.pageRows.push({pages:[o],width:u,height:c,marginTop:m}),this.width=u,this.height+=c,this.height+=m,s++}}book(e,t){let i=this.getBestBlueprints(this.pages),s=(this.pages.length-1)*this.pageSpacing.horizontal,o=i[0].artBox.width*this.pages.length,a=i[0].artBox.height;e-=s;let n=Math.max(o/e,a/t),r=Math.min(e,2*Math.round(o/n/2));this.width=r+s,this.height=Math.round(r/(o/a));let l=[],d=0;for(let e of this.pages){let t=(0,h.toJS)(i[d]);e.setBlueprint(t),e.setConfig({crop:t.artBox,width:Math.round(r/this.pages.length),height:this.height,marginLeft:d>0?this.pageSpacing.horizontal:0,type:"blueprint"}),l.push(e),d++}this.pageRows.push({pages:l,width:this.width,height:this.height,marginTop:0})}getNonEmptyPages(e){return new Promise(t=>{let i=[];for(let t of e)i.push(t.getData());Promise.all(i).then(()=>{let i=[];for(let t of e){let e=0===Object.keys(t.layerData).length;e||i.push(t)}0===i.length&&i.push(e[0]),t(i)})})}cutout(e){let t=this.seperatorHeight/2;return new Promise(i=>{let s=[];for(let e of this.pageRows)s.push(new Promise(t=>{let i=[];for(let t of e.pages)i.push(t.ready());Promise.all(i).then(()=>{t(e)})}));Promise.all(s).then(s=>{for(let i=0;i<s.length;i++){let o=s[i],a=o.pages,n=i>0?s[i-1]:void 0,r=i<s.length-1?s[i+1]:void 0,l=0,d=0;for(let i=0;i<a.length;i++){let s=o.pages[i],a=i>0?o.pages[i-1]:n?n.pages[n.pages.length-1]:void 0,c=i<o.pages.length-1?o.pages[i+1]:r?r.pages[0]:void 0,h=(this.viewMode,["photo","video","text"]),u=s.cutout(h);if(u){let i=u.x>0,o={top:i?1.5*t:0,left:i?t:0,bottom:i?1.5*t:0,right:i?t:0},n=s.artboardFill;if(a){let e=a.artboardFill;e.join(",")===n.join(",")&&(o.top=0)}if(c){let e=c.artboardFill;e.join(",")===n.join(",")&&(o.bottom=.5*t)}let r=e-(o.left+o.right),h=Math.round(u.height/u.width*r);s.setConfig({crop:u,width:r,height:h,padding:o,background:n}),l+=r+(o.left+o.right),d+=h+(o.top+o.bottom)}else{let t=Math.round(s.crop.height/s.crop.width*e);s.setConfig({crop:s.crop,width:e,height:t}),l+=e,d+=t}}(0,h.runInAction)(()=>{l>0?(o.width=l,o.height=d):o.height=0})}let o=0,a=0;for(let e of s)e.width>o&&(o=e.width),a+=e.height;this.width=o,this.height=a,i()})})}improveTextReadability(e){return e?(this._improveTextReadabilityPromise&&this._improveTextReadabilityWidth===this.width||(this._improveTextReadabilityWidth=this.width,this._improveTextReadabilityPromise=new Promise(e=>{let t=[],i=new Promise(e=>{let t=[];for(let e=0;e<this.pageRows.length;e++){let i=this.pageRows[e];for(let e of i.pages){let i=new Promise(t=>{e.ready().then(()=>{let i=[],s=e.crop;e.walkLayers(e=>{let t=(0,eM.WJ)(e,["style","content","asset"]),o=(0,eM.WJ)(e,["style","rotation"]),a=(0,eM.WJ)(e,["styleSheet","fontSize"]),n=(0,eM.WJ)(e,["styleSheet","h1","fontSize"]);if(!t||"text"!==t.type||a>=25)return;let r=(0,eM.GM)(e.frame,o),l=r.x2,d=r.x1,c=r.y1,h=r.y2,u=d>=s.x-1&&d<=s.x+s.width+1&&l>=s.x-1&&l<=s.x+s.width+1&&c>=s.y-1&&c<=s.y+s.height+1&&h>=s.y-1&&h<=s.y+s.height+1,m=a===n,p=!1;if(t&&"text"===t.type&&!m){let e=e0()(),i=e.parse(t.text),s=i.some(e=>"paragraph_open"===e.type),o=i.some(e=>"heading_open"===e.type);!s&&o&&(p=!0)}let b=(p||m)&&n>=25,x=!b&&("smallscreen"===this.viewMode||!u);t&&"text"===t.type&&x&&i.push(e.meta.name)}),e.setZoomTextLayers(i),t()})});t.push(i)}}Promise.all(t).then(()=>{e()})});i.then(()=>{Promise.all(t).then(t=>{let i={prepends:[],appends:[],height:0};for(let e of t)"prepend"===e.type?i.prepends.push(e):i.appends.push(e),i.height+=e.height;e(i)})})})),this._improveTextReadabilityPromise):(this._improveTextReadabilityWidth=0,new Promise(e=>{for(let e=0;e<this.pageRows.length;e++){let t=this.pageRows[e];for(let e of t.pages)e.setZoomTextLayers([])}e()}))}regenerate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(t=>{let i=Object.assign({mode:"rel"},e);this.regenerateCancel&&this.regenerateCancel();let[s,o]=this.getSuggestions(i);this.regenerateCancel=o,s.then(e=>{e.suggestions.length>0&&(this.setPages((0,h.toJS)(e.suggestions[0].data.pages)),this.save(),this.resetPageSuggestions(),this.resetCacheSuggestions(),t(this))})})}resetCacheSuggestions(){this._suggestionsCache={}}resetPageSuggestions(){this._suggestions=[]}getSuggestions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="cover"===this.pages[0].design.type?"cover":"spread",i=Object.assign({type:t,mode:"rel",current:{key:this.key,pages:this.pageData}},e),s=JSON.stringify(e);if(e.cache&&void 0!==this._suggestionsCache[s])return[this._suggestionsCache[s][0],()=>{}];let[o,a]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+this.store.album.key+"/spreads/suggestions",{method:"POST",data:i});return this._suggestionsCache[s]=[new Promise(e=>{o.then(t=>{let{data:i}=t;i.suggestions.map(e=>(e.key=(0,eT.Z)(),e)),e(i)}).catch(()=>{})}),a],this._suggestionsCache[s]}fetchSuggestions(){this._suggestions.clear(),this.cancelSuggestions&&this.cancelSuggestions();let[e,t]=this.getSuggestions({mode:"alt"});this.cancelSuggestions=t,e.then(e=>{(0,h.runInAction)(()=>{this._suggestions.replace(e.suggestions.map(e=>e))})}),e.catch(e=>{console.error("Couldn't fetch suggestions",e)})}moveTo(e){let t=this.store.content.items.find(t=>t.key===e.after);this.contentItem.moveTo(t.index+1);let[i]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+this.store.album.key+"/spreads/move",{method:"POST",data:{subject:this.key,after:e.after}});i.catch(e=>{console.error("Couldn't save spread move",e)})}get suggestions(){return 0===this._suggestions.length&&requestAnimationFrame(this.fetchSuggestions.bind(this)),this._suggestions}render(e,t){return(0,r.jsx)(eK,{id:e,style:t,contentItem:this.contentItem,spread:this,prepends:this.prepends,appends:this.appends,pageRows:this.pageRows,message:this.message,eventListener:this.eventListener,viewMode:this.viewMode},"spread-"+e)}constructor(e){super(e),(0,U.Z)(this,"_suggestions",[]),(0,U.Z)(this,"_suggestionsCache",{}),(0,U.Z)(this,"pages",[]),(0,U.Z)(this,"pageRows",[]),(0,U.Z)(this,"prepends",[]),(0,U.Z)(this,"appends",[]),(0,U.Z)(this,"_autoPushToServer",1),(0,U.Z)(this,"_setPageRowsId",0),(0,U.Z)(this,"eventListener",e=>{e.contentItem=this.contentItem,e.spread=this,this.trigger(e.eventType,e)}),(0,U.Z)(this,"addAssetsToStore",()=>Promise.resolve()),(0,h.makeObservable)(this,{_suggestions:h.observable,pages:h.observable,pageRows:h.observable,prepends:h.observable,appends:h.observable,setPages:h.action,resetPageSuggestions:h.action,fetchSuggestions:h.action,fill:h.action,pano:h.action,suggestions:(0,h.computed)({keepAlive:!0}),pageData:(0,h.computed)({keepAlive:!0})}),this.store=this.contentItem.store.store,this.data=this.contentItem.data,this.blueprints=[],this.pageSpacing={default:1,vertical:0,horizontal:0},this.preferBlueprint="default",this.width=0,this.height=0,this.save=(0,ei.D)(20,this.save.bind(this)),this.setPages((0,h.toJS)(this.data.pages)),this.on("mousedown",e=>{this.store.content.trigger("mousedown",e)}),this.on("mouseup",e=>{this.store.content.trigger("mouseup",e)}),this.on("click",e=>{this.store.content.trigger("click",e)}),this.on("dblclick",e=>{this.store.content.trigger("dblclick",e)}),this.on("arrow",e=>{this.store.content.trigger("scrollToTop",e)}),this.on("contextmenu",e=>{this.store.content.trigger("contextmenu",e)}),this.on("longtouch",e=>{this.store.content.trigger("longtouch",e)}),this.disposers.push((0,h.reaction)(()=>this.pages.map(e=>e.wantsServerPush),e=>{if(!this.store.ui.editMode)return;let t=!1;for(let i of e)if(i>0){t=!0;break}t&&this.autoPushToServer&&(this.save(),this.resetPageSuggestions(),this.resetCacheSuggestions())})),this.disposers.push(()=>{for(let e of this.pages)e.dispose()})}},e5=i(71708),e2=function(e){let{style:t,url:i}=e,s=(0,l.useContext)(Z.Z),o=s.album,[a,n]=(0,l.useState)([]),[d,c]=(0,l.useState)(5);function h(){c(a.length)}(0,l.useEffect)(()=>{let e=!0,[t]=s.user.FetchJSON(i,{cache:!0});return t.then(t=>{let{data:i}=t;e&&n(i.contributors)}),()=>{e=!1}},[]);let m=a.length>d?d:a.length,p=a.map(e=>e.name).slice(0,m),b=p.map((e,t)=>{let i=t<p.length-1?t===p.length-2?" & ":", ":p.length<a.length?" ...":"";return e.substr(0,20)+(e.length>20?"...":"")+i});return(0,r.jsx)(u.Qj,{children:()=>o.settings.showContributors?(0,r.jsxs)("div",{style:t,className:"jsx-ebbaa416e6091b78 myalbum contributors",children:[(0,r.jsx)("div",{className:"jsx-ebbaa416e6091b78 label",children:P.default.translate("album.madeby")}),(0,r.jsx)("div",{className:"jsx-ebbaa416e6091b78 contributor-names",children:b}),(0,r.jsxs)("div",{className:"jsx-ebbaa416e6091b78 avatars",children:[a.slice(0,m).map((e,t)=>(0,r.jsx)(e5.Z,{initials:e.initials,color:e.color,images:e.image,"data-tip":e.name,"data-tip-design":"dark","data-tip-delay":"0","data-tip-align":"bottom"},"avatar-"+t)),p.length<a.length&&(0,r.jsx)(e5.Z,{initials:"+"+(a.length-p.length),color:"white",onClick:h},"avatar-more")]}),(0,r.jsx)(v(),{id:"ebbaa416e6091b78",children:".contributors.jsx-ebbaa416e6091b78{text-align:center;color:rgba(var(--albumForegroundColor),1);padding-top:2%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.label.jsx-ebbaa416e6091b78{font-weight:lighter;font-size:15px;padding:0px;margin:0px;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;cursor:default}.avatars.jsx-ebbaa416e6091b78{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-top:25px}.avatars.jsx-ebbaa416e6091b78 .avatar+.avatar{margin-left:10px}.contributor-names.jsx-ebbaa416e6091b78{font-size:22px;font-weight:lighter}"})]}):null})},e8=class extends eY{getSize(e){return Promise.resolve({width:e.viewPort.width,height:200})}render(e,t){return(0,r.jsx)(e2,{url:this.contentItem.data.url,style:t},"contributors-"+e)}constructor(e){super(e)}};let e3={html:{html:""}};var e4=class{get isSelected(){return!!this._isSelected}set isSelected(e){!!e!==this._isSelected&&(this._isSelected=!!e)}set pin(e){e?this.pinPosition=e:this.pinPosition="top"}get pin(){return this.pinPosition}get isPinned(){return!1!==this.pinPosition&&this.pinPosition.length>0}get isDeletable(){return this._isDeletable}set isDeletable(e){this._isDeletable=!!e}get size(){return{size:this.layout.height,before:this.layout.top,after:this.layout.bottom}}get index(){return this.store.getIndex(this.key)}get label(){let e=this.index;if(0===e)return"";{let t=2*e;return t-1+"-"+t}}touchLayout(){this.touched=!0;let e=this.store.store.ui,t=e.dimensions;if(0===t.width||0===t.height)return;let i=e.getSeperatorLayout(t.width),s=t.width,o=t.height-(e.editMode?e.editBarHeight+65+65:65),a=i.height,n=i.width;(s!==this._maxLayout.width||o!==this._maxLayout.height||n!==this._seperatorWidth||a!==this._seperatorHeight)&&(this._maxLayout.width=Math.round(s),this._maxLayout.height=Math.round(o),this._maxLayout.inset={top:0},this._seperatorWidth=n,this._seperatorHeight=a,this.calculateLayout(!0))}calculateLayout(e){let t=this.store.store.ui;if(this.touched&&(e||0===this.layout.width||0===this.layout.height||t.viewMode!==this._viewMode||t.ratio!==this._ratio||t.editMode!==this._editMode)){if(this._viewMode=t.viewMode,this._ratio=t.ratio,this._editMode=t.editMode,this._maxLayout.width<=0||this._maxLayout.height<=0)return;if("html"===this.type)this.layout.width=this._maxLayout.width,this.layout.height=100,this.layout.bottom=this._seperatorHeight;else{var i,s,o,a,n,r,l,d;if((null===(i=this.data)||void 0===i?void 0:i.onlyViewInBookMode)&&"book"!==this.store.store.ui.viewMode){this.layout.width=this._maxLayout.width,this.layout.height=1e-4,this.layout.bottom=0;return}let e=this._viewMode;(null===(s=this.contentType)||void 0===s?void 0:null===(o=s.pages)||void 0===o?void 0:o.length)===1&&["cover"].includes(null===(a=this.contentType.pages[0])||void 0===a?void 0:null===(n=a.design)||void 0===n?void 0:n.type)&&(null===(r=this.contentType)||void 0===r?void 0:r.pages[0].design.type)!==void 0&&(e="book"===this.store.store.ui.viewMode?"book-"+this.contentType.pages[0].design.type:this.contentType.pages[0].design.type),void 0!==this.contentType?this.contentType.getSize({viewMode:(null===(l=this.data)||void 0===l?void 0:l.forceViewMode)?null===(d=this.data)||void 0===d?void 0:d.forceViewMode:e,viewPort:(0,h.toJS)(this._maxLayout),seperatorWidth:this._seperatorWidth,seperatorHeight:this._seperatorHeight}).then(e=>{(0,h.runInAction)(()=>{this.layout.width=Math.round(e.width),this.layout.height=Math.round(e.height),this.layout.bottom=this._seperatorHeight})}):this._unknownWarningTriggered||(this._unknownWarningTriggered=!0,console.warn("Unkown content type: '"+this.type+"'"))}}}get content(){let e=this.layout,t={width:e.width,height:e.height,marginBottom:e.bottom,position:"relative"},i=null;if("html"===this.type)i="string"==typeof this.data.html?(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:this.data.html},style:t},this.key):this.data.html;else{var s;if((null===(s=this.data)||void 0===s?void 0:s.onlyViewInBookMode)&&"book"!==this.store.store.ui.viewMode)return null;void 0!==this.contentType?i=this.contentType.render(this.key,t):this._unknownWarningTriggered||(this._unknownWarningTriggered=!0,console.warn("Unkown content type: '"+this.type+"'"))}return i}dispose(){for(let e of this.disposers)e();this.contentType&&this.contentType.dispose()}constructor(e,t,i,s=(0,eT.Z)()){switch((0,U.Z)(this,"data",{}),(0,U.Z)(this,"_isSelected",!1),(0,U.Z)(this,"_isDeletable",!0),(0,U.Z)(this,"pinPosition",""),(0,U.Z)(this,"_maxLayout",{width:0,height:0,inset:{top:0}}),(0,U.Z)(this,"_seperatorHeight",0),(0,U.Z)(this,"_seperatorWidth",0),(0,U.Z)(this,"layout",{width:0,height:0,bottom:0,top:0}),(0,U.Z)(this,"contentType",void 0),(0,U.Z)(this,"disposers",[]),(0,U.Z)(this,"setData",e=>{this.data=Object.assign(this.data,e)}),(0,U.Z)(this,"delete",()=>{this.isDeletable?this.store.delete(this):console.warn("Tried to delete undeletable content")}),(0,U.Z)(this,"moveTo",e=>{-1===e&&(e=this.store.items.length-1),"insertIndex"===e&&(e=this.store.insertIndex,this.index<=e&&e--),this.index<e&&e--,this.store.items.remove(this),this.store.items.splice(e,0,this)}),(0,h.makeObservable)(this,{data:h.observable,_isSelected:h.observable,_isDeletable:h.observable,pinPosition:h.observable,_maxLayout:h.observable,_seperatorHeight:h.observable,_seperatorWidth:h.observable,layout:h.observable,isSelected:(0,h.computed)({keepAlive:!0}),pin:h.computed,isPinned:(0,h.computed)({keepAlive:!0}),isDeletable:(0,h.computed)({keepAlive:!0}),index:(0,h.computed)({keepAlive:!0}),content:h.computed,size:(0,h.computed)({keepAlive:!0}),setData:h.action,delete:h.action,moveTo:h.action,touchLayout:h.action,calculateLayout:h.action}),void 0===i&&(i={}),void 0===i&&e3[t]&&(i=e3[t]),this.store=e,this.type=t,this.data=i,this.key=s,this.type){case"spread":this.contentType=new e1(this);break;case"clone-spread":this.clone=this.store.getByKey(this.data.target),this.contentType=new e1(this.clone),this.forceViewMode=this.data.forceViewMode;break;case"contributors":this.contentType=new e8(this)}let o=this.store.store.ui;this.disposers.push((0,h.reaction)(()=>o.viewMode+JSON.stringify(o.seperator)+"-"+o.ratio+"-"+(o.editMode?"editMode":""),()=>{this.calculateLayout(!0)}))}};(0,u.DT)(!1);var e9=class{get spreadCount(){let e=0;for(let t of this.items)"spread"===t.type&&e++;return e>0&&e--,e}get insertIndex(){for(let e=this.items.length-1;e>-1;e--)if(!this.items[e].isPinned||"top"===this.items[e].pin)return e+1;return this.items.length}get selection(){let e=this.items.filter(e=>e.isSelected);return e}set selection(e){(0,h.transaction)(()=>{for(let t of(this.deSelectAll(e),e))t.isSelected=!0})}addSpread(e){return new Promise((t,i)=>{let[s]=this.store.user.FetchJSON("https://myalbum.com/api/v2/album/"+this.store.album.key+"/spreads",{method:"POST",data:e});s.then(i=>{let{data:s}=i,o={...s};delete o.key,delete o.type;let a=this.getIndex(e.insertAfter),n=this.add(s.type,o,s.key,a+1);t(n)}).catch(e=>{i(e)})})}constructor(e,t){(0,U.Z)(this,"items",[]),(0,U.Z)(this,"indexInView",0),(0,U.Z)(this,"selectionIsInView",!0),(0,U.Z)(this,"add",(e,t,i,s)=>{let o=new e4(this,e,t,i);return void 0===s&&(s=(0,h.toJS)(this.insertIndex)),(0,h.runInAction)(()=>{this.items.splice(s,0,o)}),o}),(0,U.Z)(this,"getIndex",e=>this.items.findIndex(t=>t.key===e)),(0,U.Z)(this,"getByKey",e=>{let t=this.getIndex(e);return this.items[t]}),(0,U.Z)(this,"delete",e=>{if(e.dispose(),this.items.remove(e),e.data.links&&e.data.links.delete){let[t]=this.store.user.FetchJSON(e.data.links.delete,{method:"DELETE"});t.then(()=>{}),t.catch(e=>{console.warn(e)})}}),(0,U.Z)(this,"deSelectAll",e=>{for(let t of this.items)e&&e.includes(t)||(t.isSelected=!1)}),(0,U.Z)(this,"disposeItems",()=>{for(let e of this.items)e.dispose();this.items.clear()}),(0,U.Z)(this,"hydrate",e=>{if(!e)return;this.disposeItems();let t=0;for(let i of e){let e={...i};delete e.key,delete e.type;let s=this.add(i.type,e,i.key);0===t&&(s.isDeletable=!1),t++}}),(0,U.Z)(this,"createBlankPage",()=>{let e=this.indexInView>0?this.indexInView-1:0,t=this.items[e].key;this.addSpread({insertAfter:t}).then(e=>{this.selection=[e]}).catch(()=>{})}),(0,U.Z)(this,"dispose",()=>{this.disposeItems()}),(0,h.makeObservable)(this,{selectionIsInView:h.observable,items:h.observable,insertIndex:(0,h.computed)({keepAlive:!0}),spreadCount:h.computed,delete:h.action,deSelectAll:h.action,addSpread:h.action,disposeItems:h.action}),new eq.Z(this),this.store=e,this.hydrate(t)}};class e7{hydrate(e){this.currency=e.currency,this.products=e.products,this.assetCount=e.assetCount}findPhotobook(e){let t=Object.entries(e);if(void 0!==this.products&&void 0!==this.products.photobook)return this.products.photobook.find(e=>t.every(t=>{let[i,s]=t;return e[i]===s}))}update(){if(!this._updatePromise){let e="".concat("https://myalbum.com/api/v2","/album/").concat(this.store.album.key,"/products");this._updatePromise=this.store.user.fetch(e),this._updatePromise.then(e=>this.hydrate(e.data)).catch(()=>{this.hydrate({currency:"EUR",products:{},assetCount:0})}).finally(()=>{this._updatePromise=void 0})}}dispose(){this.disposers.forEach(e=>e())}constructor(e,t){(0,U.Z)(this,"store",void 0),(0,U.Z)(this,"currency",void 0),(0,U.Z)(this,"products",void 0),(0,U.Z)(this,"assetCount",0),(0,U.Z)(this,"disposers",[]),(0,U.Z)(this,"_updatePromise",void 0),(0,h.makeObservable)(this,{products:h.observable,currency:h.observable,assetCount:h.observable,update:h.action,hydrate:h.action}),this.store=e,this.disposers.push((0,h.reaction)(()=>e.content.items.length,()=>{this.update()})),t&&this.hydrate(t)}}var e6=i(79828);let te=0;var tt=class{onScroll(){this.ui.setScrollPosition({scrollTop:(0,e6.default)(window).scrollTop()})}onMove(e){let t={clientY:e.clientY,clientX:e.clientX};void 0===e.clientX&&void 0!==e.touches&&e.touches.length>0&&(t.clientX=e.touches[0].clientX,t.clientY=e.touches[0].clientY),this.ui.setMousePosition(t)}setEvents(){window.addEventListener("scroll",this.onScroll,{passive:!0}),window.addEventListener("mousemove",this.onMove,{passive:!0}),window.addEventListener("touchmove",this.onMove,{passive:!0}),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),this.disposers.push((0,h.reaction)(()=>this.ui._viewMode,e=>{window.localStorage.setItem("viewMode",e)})),this.disposers.push((0,h.reaction)(()=>this.ui.muted,e=>{window.localStorage.setItem("muted",e)})),this.disposers.push(()=>{window.removeEventListener("scroll",this.onScroll,{passive:!0}),window.removeEventListener("mousemove",this.onMove,{passive:!0}),window.removeEventListener("touchmove",this.onMove,{passive:!0}),window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown)})}restorePreferences(){let e=window.localStorage.getItem("viewMode");"smallscreen"!==e||this.ui.isSmallScreen||(e=void 0),["book","fill","smallscreen"].includes(e)||(e=void 0),e&&!this.ui.isSmallScreen&&(0,h.runInAction)(()=>{this.ui.viewMode=e});let t=window.localStorage.getItem("muted");void 0!==t&&(0,h.runInAction)(()=>{this.ui.muted=t})}dispose(){for(let e of(et.Z&&console.debug("disposing rootstore"),Q.Z.setTheme("light"),this.disposers))e();this.products.dispose(),this.content.dispose(),this.ui.dispose(),this.edit&&this.edit.dispose()}constructor(e){(0,U.Z)(this,"storeInstanceId",null),(0,U.Z)(this,"user",null),(0,U.Z)(this,"album",null),(0,U.Z)(this,"assets",null),(0,U.Z)(this,"content",null),(0,U.Z)(this,"products",null),(0,U.Z)(this,"ui",null),(0,U.Z)(this,"edit",null),(0,U.Z)(this,"disposers",[]),(0,U.Z)(this,"onResize",()=>{this.ui.setWindowSize({innerWidth:window.innerWidth,innerHeight:window.innerHeight,clientWidth:document.documentElement.clientWidth})}),(0,U.Z)(this,"onKeyDown",e=>{(e.metaKey||e.ctrlKey)&&69===e.keyCode&&!e.altKey&&(e.preventDefault(),this.ui.toggleEditMode())}),te++,this.storeInstanceId=te,this.user=e.user,this.album=new eP(this,e.album),this.ui=new eN(this),this.assets=new e_(this,e.asset),this.content=new e9(this,e.content),this.products=new e7(this,e.products),this.onScroll=(0,ei.P)(25,this.onScroll.bind(this)),this.onMove=(0,ei.P)(25,this.onMove.bind(this)),this.setEvents(),this.onResize(),this.restorePreferences(),et.Z&&(window.album={},window.album.album=this.album,window.album.asset=this.asset,window.album.content=this.content,window.album.ui=this.ui,this.disposers.push(()=>{delete window.album})),this.disposers.push((0,h.reaction)(()=>this.ui.editMode,e=>{e?Q.Z.setTheme("dark"):(this.content.deSelectAll(),Q.Z.setTheme("light"))}))}};let ti=(0,l.createContext)(null);var ts=i(79089),to=i(96309),ta=function(){let e=(0,l.useContext)(ti),t=(0,L.aF)(),[i,s]=(0,l.useState)(!1),[o,a]=(0,l.useState)(!1),n=(0,l.useRef)(),d=(0,l.useMemo)(()=>()=>{let i=!e.me.hasBookmarked;(0,h.runInAction)(()=>{e.me.hasBookmarked=i}),t.securePost("follow","/legacyalbum/".concat(e.key,"/follow"),{follow:i?1:0}).then(()=>{}).catch(()=>{})},[]),c=(0,l.useCallback)(()=>{var t,i,s,o;let a=e.getRelativeScrollPosition(),r=(null==a?void 0:null===(t=a.item)||void 0===t?void 0:null===(i=t.item)||void 0===i?void 0:i.key)?"#item-"+(null==a?void 0:null===(s=a.item)||void 0===s?void 0:null===(o=s.item)||void 0===o?void 0:o.key)+"-"+(null==a?void 0:a.top):"",l=new Date().getTime(),d="".concat("https://myalbum.com","/legacyalbum/").concat(e.key,"/?p=").concat(l).concat(r);if(n.current&&n.current.opener){n.current.location.href=d,n.current.focus();return}n.current=window.open(d,"album-".concat(e.key))},[]),m=(0,l.useCallback)(()=>{a(!0)},[]),p=(0,l.useCallback)(()=>{s(!0)},[]);return(0,r.jsx)(u.Qj,{children:()=>{let t=e.me.hasBookmarked,n="owner"!==e.me.role,l="owner"===e.me.role,h="owner"===e.me.role||e.settings.albumShareVisible,u="owner"===e.me.role||e.settings.albumShopVisible,b=e.settings.albumLogoVisible,g=[];if(u){let t=et.Z?"".concat("https://myalbum.com","/order/photobook/").concat(e.key):"/order/photobook/".concat(e.key,"/");g.push({type:"link",className:"accent",title:P.default.translate("legacy.order-photobook"),href:t})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(x.Z,{visible:e.menuBarVisible,children:[(0,r.jsx)("div",{children:(0,r.jsx)(x.Z.Back,{})},"left"),(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Z.Back,{},"shortback"),h&&(0,r.jsx)(f.Z,{icon:D.Ef,className:"menu-bar-button",onClick:m},"share-button"),n&&(0,r.jsx)(f.Z,{icon:t?O.xV:I.xV,onClick:d,className:"menu-bar-button",style:{color:t?"rgba(var(--accentColor), 1)":"rgba(var(--accentColorDark), 1)"}}),(0,r.jsx)(f.Z,{icon:E.iV,className:"menu-bar-button",onClick:p},"more-icon"),(0,r.jsx)(x.Z.Cart,{items:g})]},"mobile"),(0,r.jsx)("div",{children:b&&(0,r.jsx)(x.Z.Logo,{})},"center"),(0,r.jsxs)("div",{children:[l&&(0,r.jsx)(f.Z,{icon:to.faPencil,className:"menu-bar-button",onClick:c},"edit-button"),h&&(0,r.jsx)(f.Z,{icon:D.Ef,className:"menu-bar-button",onClick:m},"share-button"),n&&(0,r.jsx)(f.Z,{icon:t?O.xV:I.xV,onClick:d,className:"menu-bar-button",style:{color:t?"rgba(var(--accentColor), 1)":"rgba(var(--accentColorDark), 1)"}}),(0,r.jsx)(f.Z,{icon:E.iV,className:"menu-bar-button",onClick:p},"more-icon"),(0,r.jsx)(x.Z.Cart,{items:g})]},"right")]}),i&&(0,r.jsx)(ts.default,{album:e.key,legacyalbum:e,onClose:()=>{s(!1)}}),o&&(0,r.jsx)(R.Z,{onClose:()=>a(!1),subject:{key:e.key,type:"album"}})]})}})};(0,u.DT)(!1);var tn=class{get menuBarVisible(){return this._menuBarVisible}set menuBarVisible(e){this._menuBarVisible=e}get stats(){return this._stats}set stats(e){this._stats=e}hydrate(e){e&&(this.key=e.key,this.title=e.title,this.subTitle=e.subTitle,this.header=e.header,this.lastUpdate=new Date(1e3*e.lastUpdate),this.settings=e.settings,this.me=e.me)}setWindowSize(e){this.window=e}setScrollPosition(e){e=e>0?e:0;let t=e===this.scrollTop?this.scrollDirection:e>this.scrollTop?"down":"up";this.scrollDirection=t,this.scrollTop=e;let i=this.mouse.clientY<=60,s="down"!==t||!!i||e+65<this.window.innerHeight;this.menuBarLock||(this.menuBarVisible=s),this.window.scrollTop=e}setSettings(e){let t=JSON.parse(JSON.stringify(e));for(let e in t)"Enabled"===e.substring(e.length-7)&&(t[e.substring(0,e.length-7)+"Visible"]=t[e],delete t[e]);Object.assign(this.settings,{...t})}setMousePosition(e){Object.assign(this.mouse,{...e}),e.clientY<=60&&!this.menuBarLock&&(this.menuBarVisible=!0)}get downloadsEnabled(){return this.settings.albumDownloadsEnabled}get canContribute(){return this.settings.albumContributionsEnabled&&"owner"!==this.me.role}constructor(e){(0,U.Z)(this,"key",""),(0,U.Z)(this,"title",""),(0,U.Z)(this,"subTitle",""),(0,U.Z)(this,"header",{}),(0,U.Z)(this,"lastUpdate",new Date(0)),(0,U.Z)(this,"seo",{}),(0,U.Z)(this,"scrollTop",0),(0,U.Z)(this,"window",{innerWidth:1600,innerHeight:1200,clientWidth:1600,scrollTop:0}),(0,U.Z)(this,"mouse",{clientY:0,clientX:0}),(0,U.Z)(this,"_menuBarVisible",!0),(0,U.Z)(this,"menuBarLock",!1),(0,U.Z)(this,"access",{level:"hidden"}),(0,U.Z)(this,"settings",{}),(0,U.Z)(this,"me",{hasBookmarked:!1,role:"member"}),(0,U.Z)(this,"_stats",{}),(0,h.makeObservable)(this,{key:h.observable,title:h.observable,subTitle:h.observable,header:h.observable,lastUpdate:h.observable,seo:h.observable,window:h.observable,mouse:h.observable,_menuBarVisible:h.observable,settings:h.observable,me:h.observable,_stats:h.observable,hydrate:h.action,setScrollPosition:h.action,setMousePosition:h.action,setWindowSize:h.action,setSettings:h.action,menuBarVisible:h.computed,stats:h.computed,downloadsEnabled:h.computed,canContribute:h.computed}),this.hydrate(e)}},tr=i(73935);let tl=new String('.info-bar.jsx-c1caf5a21b012fe4{padding:30px}.info-bar.jsx-c1caf5a21b012fe4 h2.jsx-c1caf5a21b012fe4{font-size:2.5rem;margin:0px;margin-bottom:1rem;font-family:"Source Sans Pro",sans-serif;font-weight:normal}.info-bar.jsx-c1caf5a21b012fe4 .description.jsx-c1caf5a21b012fe4{font-family:"Source Sans Pro",sans-serif;font-weight:normal;font-size:16px}.info-bar.jsx-c1caf5a21b012fe4 .download.jsx-c1caf5a21b012fe4{font-family:"Source Sans Pro",sans-serif;font-weight:normal;font-size:14px;border:1px solid white;-webkit-border-radius:100px;-moz-border-radius:100px;border-radius:100px;line-height:30px;height:30px;display:inline-block;padding-left:20px;padding-right:20px;margin-top:20px;cursor:pointer}');tl.__hash="c1caf5a21b012fe4";let td=new String('.comments.jsx-f4c38680113e94eb{padding:30px}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb{}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb{background-color:rgba(76,76,76,.5);border:0px;resize:none;width:100%;height:70px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:15px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;margin-bottom:40px;color:white;font-family:"MyAlbumMain";font-size:14px!important}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb::-webkit-input-placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb:-moz-placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb::-moz-placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb:-ms-input-placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb::-ms-input-placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .new-comment.jsx-f4c38680113e94eb textarea.jsx-f4c38680113e94eb::placeholder{color:rgba(255,255,255,.5)}.comments.jsx-f4c38680113e94eb .comment .comment-delete{position:absolute;top:0px;right:6px;cursor:pointer;width:20px;height:20px;display:none}.comments.jsx-f4c38680113e94eb .comment.deletable:hover .comment-delete{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.comments.jsx-f4c38680113e94eb .comment{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;font-size:14px;position:relative}.comments.jsx-f4c38680113e94eb .comment .comment-content{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;margin-left:10px}.comments.jsx-f4c38680113e94eb .comment .comment-name{font-size:12px}.comments.jsx-f4c38680113e94eb .comment .comment-date{opacity:.5;font-size:12px;margin-bottom:10px}.comments.jsx-f4c38680113e94eb .comment-text{white-space:pre-line}.comments.jsx-f4c38680113e94eb .comment+.comment{margin-top:40px}');td.__hash="f4c38680113e94eb";let tc=new String('.grid.jsx-67db4c2c9cebb328 .griditem-info{height:32px;line-height:33px;overflow:hidden;position:absolute;top:15px;right:15px;display:inline-block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;z-index:100;white-space:nowrap;color:white;font-size:12px;text-align:center;cursor:default;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.myalbum.slideview:not(.show){visibility:hidden!important}.grid.jsx-67db4c2c9cebb328 .griditem-info:empty{display:none}.grid.jsx-67db4c2c9cebb328 .griditem-comments{display:inline-block;opacity:1;height:inherit;line-height:inherit}.grid.jsx-67db4c2c9cebb328 .griditem-comments[data-amount]:after{content:attr(data-amount);color:white;padding-left:10px;padding-right:10px;font-family:"Source Sans Pro",sans-serif;font-weight:normal;font-size:14px;height:32px;display:inline-block;background-color:rgba(0,0,0,.7);border:1px solid rgba(255,255,255,.5);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.grid.jsx-67db4c2c9cebb328 .griditem-comments[data-amount="0"]{display:none}');tc.__hash="67db4c2c9cebb328";var th=i(77917);let tu=[];tu.push({title:"slideviewdetails.exif",fields:{title:{label:"slideviewdetails.exif.title"},dateTaken:{label:"slideviewdetails.exif.date"},fileName:{label:"slideviewdetails.exif.filename"},width:{label:"slideviewdetails.exif.dimensions",suffix:{field:"height",prefix:" x "}},fileSize:{label:"slideviewdetails.exif.filesize"},software:{label:"slideviewdetails.exif.software"},cameraBrand:{label:"slideviewdetails.exif.cameraBrand"},cameraModel:{label:"slideviewdetails.exif.camera"},lensName:{label:"slideviewdetails.exif.lens"},focalLength:{label:"slideviewdetails.exif.focallength",suffix:" mm"},shutterSpeed:{label:"slideviewdetails.exif.shutterspeed"},aperture:{label:"slideviewdetails.exif.aperture",prefix:" "},duration:{label:"slideviewdetails.exif.duration"},fps:{label:"slideviewdetails.exif.fps",suffix:"slideviewdetails.exif.fps.suffix"},bitrate:{label:"slideviewdetails.exif.bitrate"},ISO:{label:"slideviewdetails.exif.iso"},flashFired:{label:"slideviewdetails.exif.flash",values:{false:"base.no",true:"base.yes"}},exposureBias:{label:"slideviewdetails.exif.exposureBias",suffix:" EV"},comment:{label:"slideviewdetails.exif.comment"},keywords:{label:"slideviewdetails.exif.keywords"}}}),tu.push({title:"slideviewdetails.contact",fields:{creatorName:{label:"slideviewdetails.contact.name"},creatorTitle:{label:"slideviewdetails.contact.title"},creatorAddress:{label:"slideviewdetails.contact.address"},creatorZipcode:{label:"slideviewdetails.contact.zipcode"},creatorCity:{label:"slideviewdetails.contact.city"},creatorRegion:{label:"slideviewdetails.contact.region"},creatorCountry:{label:"slideviewdetails.contact.country"},creatorPhone:{label:"slideviewdetails.contact.phone"},creatorEmail:{label:"slideviewdetails.contact.email"},creatorWebsite:{label:"slideviewdetails.contact.website"}}}),tu.push({title:"slideviewdetails.iptc",fields:{IPTCHeadline:{label:"slideviewdetails.iptc.headline"},IPTCSubjectCode:{label:"slideviewdetails.iptc.subjectcode"},IPTCDescriptionWriter:{label:"slideviewdetails.iptc.descriptionwriter"},IPTCCategory:{label:"slideviewdetails.iptc.category"},IPTCOtherCategories:{label:"slideviewdetails.iptc.otherCatergories"}}}),tu.push({title:"slideviewdetails.image",fields:{imageGenre:{label:"slideviewdetails.image.genre"},imageSceneCode:{label:"slideviewdetails.image.sceneCode"},imageSublocation:{label:"slideviewdetails.image.sublocation"},imageRegion:{label:"slideviewdetails.image.region"},imageCity:{label:"slideviewdetails.image.city"},imageCountryName:{label:"slideviewdetails.image.countryName"},imageCountryISO:{label:"slideviewdetails.image.countryCode"}}}),tu.push({title:"slideviewdetails.workflow",fields:{workflowJobIdentifier:{label:"slideviewdetails.workflow.jobIdentifier"},workflowInstructions:{label:"slideviewdetails.workflow.instructions"},workflowCreditLine:{label:"slideviewdetails.workflow.creditLine"},workflowSource:{label:"slideviewdetails.workflow.source"}}}),tu.push({title:"slideviewdetails.copyright",fields:{copyright:{values:{1:"slideviewdetails.copyright"},label:"slideviewdetails.copyright.copyright"},copyrightText:{label:"slideviewdetails.copyright"},copyrightUsage:{label:"slideviewdetails.copyright.usage"},copyrightUrl:{label:"slideviewdetails.copyright.url"}}});var tm=(0,H.observer)(function(e){var t,i,s;let{details:o,itemType:a,SlideView:n}=e,d=(0,l.useContext)(ti),c=(0,L.aF)(),h=[1,10].includes(a)&&(d.settings.albumDownloadsEnabled||"owner"===d.me.role),u="owner"===d.me.role&&!c.subscription.features.download,[m,p]=(0,l.useState)(!1);!function(e){let t=document.createElement("textarea");for(let i in e)t.innerHTML=e[i],e[i]=t.value}(o),(t=o).duration&&(t.duration>3600?t.duration=new Date(1e3*t.duration).toISOString().substr(11,8):t.duration=new Date(1e3*t.duration).toISOString().substr(14,5)),(i=o).hasOwnProperty("fileSize")&&(i.fileSize=(0,eM.td)(1048576*i.fileSize,2)),(s=o).hasOwnProperty("bitrate")&&(s.bitrate=(0,eM.TB)(s.bitrate,2));let b=(0,l.useCallback)(()=>{u?p(!0):n.currentItem()._download()},[u]);return(0,r.jsxs)("div",{className:"jsx-".concat(tl.__hash)+" info-bar",children:[(0,r.jsx)("h2",{className:"jsx-".concat(tl.__hash),children:P.default.translate("base.description")}),(0,r.jsx)("div",{className:"jsx-".concat(tl.__hash)+" description",children:o.description}),h&&(0,r.jsx)("div",{onClick:b,className:"jsx-".concat(tl.__hash)+" download",children:P.default.translate("context.download-original")}),tu.map(e=>(0,r.jsx)(th.Z,{title:e.title,fields:e.fields,data:o},e.title)),m&&(0,r.jsx)(eu.Z,{onClose:()=>p(!1)}),(0,r.jsx)(v(),{id:tl.__hash,children:tl})]})}),tp=i(30384);function tb(e){let{data:t}=e,i=(0,l.useRef)(),s=t.comment.replace(/<br\s?\/?>/g,"");(0,l.useEffect)(()=>{window.myalbum.require("Avatars",function(e){e.generate(i.current)})},[]);let o=["comment"];return t.fromUser&&o.push("deletable"),(0,r.jsxs)("div",{className:o.join(" "),children:[(0,r.jsx)("div",{ref:i,className:"avatar","data-avatar":"true","data-url":t.avatar_url,"data-color":t.avatar_color,"data-text":t.avatar_initials}),(0,r.jsxs)("div",{className:"comment-content",children:[(0,r.jsx)("div",{className:"comment-name",children:t.name}),(0,r.jsx)("div",{className:"comment-date",children:t.date}),(0,r.jsx)("div",{className:"comment-text",children:s})]}),(0,r.jsx)("div",{className:"comment-delete",onClick:function(){e.onDelete(t.key)},children:(0,r.jsx)(j.G,{icon:tp.uM,size:"1x",color:"white"})})]})}var tx=function(e){let[t,i]=(0,l.useState)(""),[s,o]=(0,l.useState)([]),a=(0,L.aF)();function n(e){w.Z.Confirm({title:P.default.translate("legacy.delete-comment-title"),okButtonText:P.default.translate("base.delete")}).then(()=>{a.securePost("removecomment","/comment/remove",{key:e}).then(e=>{e.status&&o(e.comments)}).catch(()=>{})}).catch(()=>{})}return(0,l.useEffect)(()=>{let[t]=a.FetchJSON("/legacyalbum/"+e.itemKey+"/itemdetails");t.then(e=>{let{data:t}=e;o(t.comments)}).catch(e=>{console.error(e)})},[]),(0,l.useEffect)(()=>{let t=e.album.items.getInstance(e.itemKey);t.item.Update({social:[0,s.length]},{is_replacement:!0}),e.onUpdate()},[s.length]),(0,r.jsxs)("div",{className:"jsx-".concat(td.__hash)+" comments",children:[a.isLoggedIn&&(0,r.jsx)("div",{className:"jsx-".concat(td.__hash)+" new-comment",children:(0,r.jsx)("textarea",{value:t,onKeyDown:function(s){s.stopPropagation(),13!=s.keyCode||s.altKey||s.shiftKey||(s.preventDefault(),i(""),a.securePost("addcomment","/comment/add",{itemkey:e.itemKey,comment:t}).then(e=>{o(e.comments)}).catch(()=>{}))},onKeyUp:function(e){e.stopPropagation(),27==e.keyCode&&setTimeout(function(){e.target.blur()},20)},onChange:function(e){i(e.target.value)},placeholder:P.default.translate("legacy.write-comment-placeholder"),className:"jsx-".concat(td.__hash)})}),s.map(e=>(0,r.jsx)(tb,{data:e,onDelete:n},e.key)),(0,r.jsx)(v(),{id:td.__hash,children:td})]})};function tg(e){let{item:t,domains:i}=e,{sizes:s}=t,[o,a,n]=s.sort((e,t)=>{let[,i,s]=e,[,o,a]=t;return o-i-(a-s)}),l=[o,a,n].filter(e=>Array.isArray(e)?"error"!==e[0]:e).map(e=>"".concat(i[e[4]]).concat(e[3]));if(0===l.length)return null;let d=1===t.type;return(0,r.jsxs)("div",{style:{padding:30},children:[(0,r.jsx)(ed.Z,{url:l[0],showLink:!1,size:49}),(0,r.jsx)("div",{style:{height:40}}),d&&(0,r.jsx)(el.Z,{urls:l})]})}var tf=i(45956),tw=function(){let e=(0,l.useContext)(ti),t=(0,l.useRef)(),[i,s]=(0,l.useState)(!1),[o,a]=(0,l.useState)(!1),[n,d]=(0,l.useState)(!1),c=e.settings.albumLikesCommentsEnabled,u=e.settings.albumShareVisible,m=(0,l.useRef)(null),p=(0,L.aF)(),b="".concat("https://myalbum.com","/res/package/js/api-album.js?hl=").concat(P.default.language);function x(){if(!m.current.SlideView.currentItem())return;let e=m.current.SlideView.currentItem().item,t=m.current.SlideView.icons.Get("comments");t&&t.setAttribute("data-amount",e.social[1]);let i=document.getElementById("griditem-comments-"+e.key);i&&i.setAttribute("data-amount",e.social[1])}function g(e,t,i){var s=document.createElement("div");s.className="griditem-info";var o=document.createElement("div");o.className="griditem-comments",o.id="griditem-comments-"+e.key,s.appendChild(o),i.appendChild(s),e.commentsEl=o,t.social&&2==t.social.length&&o.setAttribute("data-amount",t.social[1]),o.addEventListener("click",function(){m.current.SlideView.sidebar.autoOpen("social")})}return(0,l.useEffect)(()=>{let e=(0,h.reaction)(()=>p.token,()=>{var e;m.current&&m.current.setAuthorization(null===(e=p.token)||void 0===e?void 0:e.token)});return()=>{e()}},[]),(0,tf.Z)(()=>{let i=document.createElement("div");i.id="holder",t.current.innerHTML="",t.current.appendChild(i);let o=t=>{m.current=new myalbum.album.Create("holder",{showHeader:!0,autoplayVideo:!0,onRequestAuthorization:()=>{if(p.isLoggedIn)return new Promise(e=>{p.refreshToken().then(()=>{e(p.token.token)})})}}),m.current.states.Change("windowLoad",!0),m.current.grid.on("renderItem",g),t&&m.current.setAuthorization(t),m.current.SlideView.on("zoomIn",function(){e.menuBarLock=!0,e.menuBarVisible=!1,Q.Z.setTheme("dark")}),m.current.SlideView.on("zoomOut",function(){e.menuBarLock=!1,Q.Z.setTheme("light")}),m.current.on("getSlideViewIcons",function(e,t){let i=[1,10].includes(e.type);c&&t.push({id:"comments",onClick:(function(){m.current.SlideView.sidebar.OpenAndRender("social")}).bind(this)}),u&&i&&t.push({id:"share",onClick:(function(){m.current.SlideView.sidebar.OpenAndRender("share")}).bind(this)}),t.push({id:"info",onClick:(function(){m.current.SlideView.sidebar.OpenAndRender("info")}).bind(this)})}),m.current.on("getSlideViewTabs",function(e,t){let i=[1,10].includes(e.type);c&&t.push({id:"social",Render:(function(t){var i=document.createElement("div");t(i),a({el:i,itemKey:e.key})}).bind(this)}),u&&i&&t.push({id:"share",Render:(function(t){var i=document.createElement("div");t(i),d({el:i,item:e})}).bind(this)}),t.push({id:"info",Render:(function(t){var i=document.createElement("div");t(i),m.current.getItemDetails(e.key,function(t){s({el:i,itemKey:t,itemType:e.type,details:m.current.itemdata[t].details,SlideView:m.current.SlideView})})}).bind(this)})}),m.current.SlideView.on("slideChange",(function(){x()}).bind(this)),e.getRelativeScrollPosition=()=>m.current.grid.getRelativeScrollPosition(),m.current._setAlbumData({key:e.key,title:e.title,subTitle:e.subTitle,header:(0,h.toJS)(e.header)}),m.current.load(e.key)};if(p.isLoggedIn){var n;(null===(n=p.token)||void 0===n?void 0:n.token)?o(p.token.token):p.refreshToken().then(e=>{o(e.token)})}else o();return()=>{m.current&&m.current.destroy()}},{url:b}),(0,r.jsxs)("div",{className:"jsx-".concat(tc.__hash),children:[(0,r.jsx)("div",{ref:t,className:"jsx-".concat(tc.__hash)+" grid"}),(0,r.jsx)(v(),{id:tc.__hash,children:tc}),i&&(0,r.jsx)(ty,{target:i.el,details:i.details,itemType:i.itemType,itemKey:i.itemKey,SlideView:i.SlideView}),n&&(0,r.jsx)(tv,{target:n.el,item:n.item,domains:m.current.domains}),o&&(0,r.jsx)(tk,{target:o.el,itemKey:o.itemKey,album:m.current,onUpdate:x})]},"embed")};function ty(e){return tr.createPortal((0,r.jsx)(tm,{details:e.details,itemType:e.itemType,SlideView:e.SlideView}),e.target)}function tv(e){let{target:t,item:i,domains:s}=e;return tr.createPortal((0,r.jsx)(tg,{item:i,domains:s}),t)}function tk(e){return tr.createPortal((0,r.jsx)(tx,{itemKey:e.itemKey,album:e.album,onUpdate:e.onUpdate}),e.target)}function tj(){var e,t;let i=(0,l.useContext)(ti),s="".concat("https://myalbum.com","/album/").concat(i.key,"/"),o=!(null==i?void 0:null===(e=i.seo)||void 0===e?void 0:e.albumIndexingEnabled);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ey(),{children:(null==i?void 0:null===(t=i.seo)||void 0===t?void 0:t.ua)&&(0,r.jsx)(ej,{ua:i.seo.ua})}),(0,r.jsx)(ev.PB,{title:i.title,description:i.subtitle||" ",noindex:o,nofollow:o,openGraph:{title:i.title,description:i.subtitle,url:s,images:[{url:"".concat(s,"coverphoto.jpg"),width:1200,height:675}]}})]})}var tz=function(e){let t=(0,l.useRef)(new tn({title:e.album.data.title,subTitle:e.album.data.subTitle,key:e.album.data.key,lastUpdate:e.album.data.lastGridUpdate,header:e.album.data.header,settings:e.album.settings,me:e.album.me})).current,i=(0,l.useRef)((0,ei.P)(25,function(){t.setScrollPosition((0,e6.default)(window).scrollTop())})).current,s=(0,l.useRef)((0,ei.P)(25,function(e){let i={clientY:e.clientY,clientX:e.clientX};void 0===e.clientX&&void 0!==e.touches&&e.touches.length>0&&(i.clientX=e.touches[0].clientX,i.clientY=e.touches[0].clientY),t.setMousePosition(i)})).current;return(0,l.useEffect)(()=>(window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("mousemove",s,{passive:!0}),window.addEventListener("touchmove",s,{passive:!0}),()=>{window.removeEventListener("scroll",i,{passive:!0}),window.removeEventListener("mousemove",s,{passive:!0}),window.removeEventListener("touchmove",s,{passive:!0})}),[]),(0,r.jsxs)(ti.Provider,{value:t,children:[(0,r.jsx)(tj,{}),(0,r.jsx)(ex.Z,{}),(0,r.jsx)(ta,{}),(0,r.jsx)(tw,{})]})},tS=i(68896),tC=i(28529),tA=i(56931),tM=i(69091),tP=!0,t_=function(e){var t,i;let s=e.statusCode,o=e.version,a=e.invite,n=(0,L.aF)(),d=(0,eC.useRouter)(),m="album-".concat(null===(t=e.album)||void 0===t?void 0:t.data.key);switch((0,l.useEffect)(()=>{var t;if(!(null===(t=e.album)||void 0===t?void 0:t.data.key))return;let i=(0,h.reaction)(()=>n.isLoggedIn,()=>{(0,tS.G)(n,m,a).then(t=>{e.access.me.hasAccess&&!t.me.hasAccess?d.replace(d.asPath):!e.access.me.hasAccess&&t.me.hasAccess&&d.replace(d.asPath)})});return()=>{i()}},[]),s){case 200:case 401:if(!(null===(i=e.access.me)||void 0===i?void 0:i.hasAccess))return(0,r.jsx)(u.Qj,{children:()=>(0,r.jsx)(tC.Z,{access:e.access,slug:m,invite:a,labels:[{icon:tA.by,label:P.default.translate("access.".concat(e.access.subject.accessLevel,".title"))},{icon:tM.FV,label:P.default.translate("followers.title",{count:e.access.subject.totals.followerCount})}]})});{let t={...e};delete t.statusCode,delete t.className,delete t.version;let i=null;switch(o){case"v4":i=(0,r.jsx)(tT,{...t});break;case"legacy":i=(0,r.jsx)(tz,{...t})}return i}case 404:return(0,r.jsx)(eS.default,{});default:return(0,r.jsx)(c(),{statusCode:s})}};function tT(e){let t=(0,L.aF)(),i=e.album.data.key,{contents:s,...o}=e.album.data,a=l.useRef(new tt({user:t,album:{...o,settings:e.album.settings},products:e.products,asset:{url:"https://myalbum.com/api/v2/album/"+i+"/assets"},content:s})).current;return(0,l.useEffect)(()=>{let e=(0,h.reaction)(()=>t.isLoggedIn,e=>{!e&&a.ui.editMode&&a.ui.setEditMode(!1)});return()=>{e(),a.dispose()}},[]),(0,l.useEffect)(()=>{a.content.hydrate(s)},[s]),(0,r.jsxs)(Z.Z.Provider,{value:a,children:[(0,r.jsx)(ez,{}),!e.fromApp&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(J,{}),(0,r.jsx)("div",{style:{height:65}})]}),(0,r.jsx)(ef,{})]})}},8181:function(e,t,i){"use strict";var s=i(67294);let o=(0,s.createContext)(null);t.Z=o},55166:function(e,t,i){"use strict";i.d(t,{h:function(){return m},O:function(){return p}});var s=i(39214),o=i(21333),a=i(84528),n=i(77185),r=i(14924);let l={method:"GET"};class d extends Error{constructor(...e){super(...e),(0,r.Z)(this,"name","AbortError")}}class c{get ok(){return this.request.status>=200&&this.request.status<300}get status(){return this.request.status}text(){return new Promise(e=>{e(this.request.response)})}json(){return new Promise((e,t)=>{try{e(JSON.parse(this.request.response))}catch(e){t(e)}})}constructor(e){this.request=e}}fetch;var h=window.fetch?fetch:function(e,t){let i=Object.assign({},l,t);return new Promise((t,s)=>{let o=new XMLHttpRequest;o.open(i.method,e),o.addEventListener("error",e=>{s(Error("Network error",e))}),o.addEventListener("load",()=>{t(new c(o))}),i.mode&&"cors"===i.mode&&(o.withCredentials=!0),i.headers&&Object.keys(i.headers).forEach(e=>{o.setRequestHeader(e,i.headers[e])}),i.signal&&i.signal.addEventListener("abort",()=>{o.abort(),s(new d("Aborted"))}),i.body?o.send(i.body):o.send()})},u=i(21042);function m(e,t){return new Promise((i,s)=>{var o;let a=h("".concat("https://myalbum.com/api/v1","/album/").concat(t,"?noitems=1"),{headers:{MAAUTHORIZATION:e&&(null==e?void 0:null===(o=e.token)||void 0===o?void 0:o.token)?"Bearer ".concat(e.token.token):"ClientToken V5BkhO7GlUH#CjgXcxC74frqlK_vy8cp"}});a.then(t=>{t.text().then(t=>{let s=JSON.parse(t),o={data:s.album,settings:s.settings};e&&(o.user=s.user),i(o)})}).catch(e=>{if(404===e.statusCode)return s(e);i({data:{key:t},statusCode:e.statusCode})})})}function p(e,t,i){return new Promise(r=>{let l=(0,u.lX)(a=>{e.setUrl("".concat("https://myalbum.com","/upload")),e.setUser(t),e.clear(),e.addFiles(a),new Promise((e,i)=>{t.isLoggedIn?e():(0,s.H)(t,{tab:"login",loginInfoText:n.default.translate("album.contribute.login"),registerInfoText:n.default.translate("album.contribute.login")}).then(e).catch(e=>{"popup_closed_by_user"===e.error&&i()})}).then(()=>{let s=o.Z.Progress({modalStyle:{width:"100vw",maxWidth:500},onCancel:()=>new Promise(t=>{e.pause(),o.Z.Confirm({title:n.default.translate("myalbums.add.cancel.title"),description:n.default.translate("myalbums.add.cancel.description"),okButtonText:n.default.translate("myalbums.add.cancel.button-ok"),cancelButtonText:n.default.translate("myalbums.add.cancel.button-cancel")}).then(()=>{e.clear(),t()}).catch(()=>{e.resume()})})});e.onInitUpload(()=>new Promise((s,o)=>{let a=new URL("".concat("https://myalbum.com","/upload/init"));a.searchParams.append("albumkey",i.key),a.searchParams.append("isaddrequest",1);let[n]=t.FetchJSON(a.toString());n.then(t=>{e.addParam("uploadkey",t.data.uploadKey),s()}).catch(o)})),e.onProgress(()=>{s.setPercentage(e.progress.percentage),s.setTitle(n.default.translate("myalbums.add.progress.in-progress",{count:e.files.size}))}),e.onStatus(()=>{function i(i,o,a){if(!e.isActive)return;let[n]=t.FetchJSON("/api/v1/member/upload/".concat(i,"/status/"),{legacy:!0});n.then(e=>{let n=e.data;if(n.status)switch(n.status){case"processing":s(i,o,a);break;case"complete":let[r]=t.FetchJSON(n.action,{legacy:!0,method:"GET"===n.actionMethod?"GET":"POST"});r.then(e=>{o(e.data)}).catch(a)}else s(i,o,a)}).catch(a)}function s(e,t,s){setTimeout(()=>{i(e,t,s)},1e3)}return new Promise((t,s)=>{let o=e.getParam("uploadkey");new Promise((e,t)=>{i(o,e,t)}).then(i=>{e.setData("album",i.albumKey),e.setData("errors",{corrupt:i.corrupt,durationTooLong:i.tooLong,resolutionTooLarge:i.resolutionExceeded,filesizeTooLarge:i.tooLarge,resolutionTooSmall:i.tooSmall}),e.setData("filesCount",{successCount:parseInt(i.nrAccepted,10)-parseInt(i.nrFailed,10),acceptedCount:parseInt(i.nrAccepted,10),failedCount:parseInt(i.nrFailed,10)}),t()}).catch(s)})}),e.onComplete(()=>new Promise(t=>{s.setIndeterminate(!0),s.setTitle(n.default.translate("myalbums.add.progress.processing",{count:e.files.size})),t()})),e.start().then(()=>{l(),r(),s.close()}).catch(t=>{if(e.cancel(),e.clear(),s.close(),l(),t){let i=new Map;t.statusCode&&i.set("status",t.statusCode),t.msg&&t.msg.length&&i.set("message",t.msg),t.response&&Object.entries(t.response).forEach(e=>{let[t,s]=e;i.set(t,s)}),console.log("DEBUG INFO"),console.log(e.debug),console.log("DEBUG INFO"),o.Z.Alert({title:n.default.translate("base.error"),description:"Upload error: ".concat(Array.from(i).map(e=>{let[t,i]=e;return"".concat([t,i].filter(e=>void 0!==e).join(": "))}).join(", "))})}})}).catch(()=>{e.clear(),l()})},{multiple:!0,accept:a.v.join(", ")})})}},21042:function(e,t,i){"use strict";function s(e){switch(e.state){case e.STATE_WAITING:return"title";case e.STATE_IN_PROGRESS:return"progress";case e.STATE_COMPLETE:case e.STATE_ERROR:return"ready"}}function o(){return!!("undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("android")>-1)}function a(){return!!("undefined"!=typeof navigator&&(o()||navigator.userAgent.toLowerCase().indexOf("iphone")>-1||navigator.userAgent.toLowerCase().indexOf("ipad")>-1||void 0!==window.DocumentTouch&&document instanceof window.DocumentTouch))}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("input");return i.style.position="absolute",i.style.top="-100px",i.style.left="-100px",i.style.width="1px",i.style.height="1px",i.setAttribute("type","file"),i.addEventListener("change",t=>{e(t.target.files)}),Object.entries(t).forEach(e=>{let[t,s]=e;i.setAttribute(t,s)}),document.body.appendChild(i),i.click(),()=>{i.remove()}}i.d(t,{Dt:function(){return o},lX:function(){return n},sD:function(){return a},vo:function(){return s}})}},function(e){e.O(0,[150],function(){e.E(9980),e.E(6270)},5),e.O(0,[1664,9494,9980,4716,3126,9620,5082,503,9774,2888,179],function(){return e(e.s=93452)}),_N_E=e.O()}]);
//# sourceMappingURL=[album]-dae6e8323478d7b9.js.map